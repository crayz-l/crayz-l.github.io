<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Blog目录</title>
      <link href="/posts/4199349087/"/>
      <url>/posts/4199349087/</url>
      
        <content type="html"><![CDATA[<ol class="series-items"><li><a href="/posts/205686455/" title="OS报告">OS报告</a></li><li><a href="/posts/1990012807/" title="数据库学习笔记">数据库学习笔记</a></li><li><a href="/posts/3972354381/" title="头歌_数据库实验">头歌_数据库实验</a></li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>头歌_数据库实验</title>
      <link href="/posts/3972354381/"/>
      <url>/posts/3972354381/</url>
      
        <content type="html"><![CDATA[<ol class="series-items"><li><a href="/posts/33322/" title="实验2 MySQL软件操作及建库建表建数据">实验2 MySQL软件操作及建库建表建数据</a></li><li><a href="/posts/57811/" title="实验3 MySQL的DDL语言">实验3 MySQL的DDL语言</a></li><li><a href="/posts/43911/" title="实验4 MySQL单表查询">实验4 MySQL单表查询</a></li><li><a href="/posts/43230/" title="实验5 SQL的多表查询-1">实验5 SQL的多表查询-1</a></li><li><a href="/posts/48365/" title="实验6 SQL的多表查询-2">实验6 SQL的多表查询-2</a></li><li><a href="/posts/15145/" title="实验7 SQL的复杂多表查询-1">实验7 SQL的复杂多表查询-1</a></li><li><a href="/posts/14962/" title="实验8 SQL的复杂多表查询-2">实验8 SQL的复杂多表查询-2</a></li><li><a href="/posts/90/" title="实验9 SQL视图">实验9 SQL视图</a></li><li><a href="/posts/54623/" title="实验10 SQL互联网业务查询-1">实验10 SQL互联网业务查询-1</a></li><li><a href="/posts/21532/" title="实验11 SQL互联网业务查询-2">实验11 SQL互联网业务查询-2</a></li><li><a href="/posts/973/" title="实验12 数据库E-R图设计">实验12 数据库E-R图设计</a></li><li><a href="/posts/31554/" title="实验13 数据库编程-1">实验13 数据库编程-1</a></li><li><a href="/posts/3767/" title="实验14 数据库编程-2">实验14 数据库编程-2</a></li><li><a href="/posts/32272/" title="实验16 数据库触发器与权限">实验16 数据库触发器与权限</a></li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>数据库学习笔记</title>
      <link href="/posts/1990012807/"/>
      <url>/posts/1990012807/</url>
      
        <content type="html"><![CDATA[<ol class="series-items"><li><a href="/posts/802921560/" title="DataBase 常用函数">DataBase 常用函数</a></li><li><a href="/posts/1419064164/" title="DataBase 增删改语句">DataBase 增删改语句</a></li><li><a href="/posts/1146913277/" title="DataBase 查询语句">DataBase 查询语句</a></li><li><a href="/posts/3438945314/" title="DataBase 聚合函数">DataBase 聚合函数</a></li><li><a href="/posts/2160201343/" title="DataBase 视图">DataBase 视图</a></li><li><a href="/posts/4201200877/" title="DataBase 连接">DataBase 连接</a></li><li><a href="/posts/1132319962/" title="DataBase 存储过程">DataBase 存储过程</a></li><li><a href="/posts/1698569466/" title="DataBase 触发器和事件">DataBase 触发器和事件</a></li><li><a href="/posts/1137404687/" title="DataBase 事务">DataBase 事务</a></li><li><a href="/posts/129956530/" title="DataBase 数据类型">DataBase 数据类型</a></li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>实验16 数据库触发器与权限</title>
      <link href="/posts/32272/"/>
      <url>/posts/32272/</url>
      
        <content type="html"><![CDATA[<h1 id="第1关-执行-create-user-创建以2022100904为用户名的用户-同时设置其密码为root1234">第1关 执行 CREATE USER 创建以2022100904为用户名的用户，同时设置其密码为root1234</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;2022100904&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED <span class="keyword">WITH</span> mysql_native_password <span class="keyword">BY</span> <span class="string">&#x27;root1234&#x27;</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SELECT</span> mysql.user.Host, mysql.user.User <span class="keyword">FROM</span> mysql.user <span class="keyword">WHERE</span> <span class="keyword">USER</span> <span class="operator">=</span> <span class="string">&#x27;2022100904&#x27;</span>;</span><br></pre></td></tr></table></figure><h1 id="第2关-给予创建的用户2022100904在mydata数据库中授予-j-表-select-权限">第2关 给予创建的用户2022100904在mydata数据库中授予&quot;J&quot; 表 SELECT 权限</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span> <span class="keyword">ON</span> mydata.J <span class="keyword">TO</span> <span class="string">&#x27;2022100904&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SHOW</span> GRANTS <span class="keyword">FOR</span> <span class="string">&#x27;2022100904&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br></pre></td></tr></table></figure><h1 id="第3关-给予创建的用户2022100904-2022100908授予-j-表-的all-privileges权限">第3关 给予创建的用户2022100904、2022100908授予&quot;J&quot;表 的ALL PRIVILEGES权限</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> <span class="keyword">ON</span> mydata.J <span class="keyword">TO</span> <span class="string">&#x27;2022100904&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> <span class="keyword">ON</span> mydata.J <span class="keyword">TO</span> <span class="string">&#x27;2022100908&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SHOW</span> GRANTS <span class="keyword">FOR</span> <span class="string">&#x27;2022100904&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"><span class="keyword">SHOW</span> GRANTS <span class="keyword">FOR</span> <span class="string">&#x27;2022100908&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br></pre></td></tr></table></figure><h1 id="第4关-给予创建的用户2022100904在mydata数据库中授予-j-表的update和insert权限">第4关 给予创建的用户2022100904在mydata数据库中授予“J”表的UPDATE和INSERT权限</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line"></span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">UPDATE</span>,<span class="keyword">INSERT</span> <span class="keyword">ON</span> mydata.J <span class="keyword">TO</span> <span class="string">&#x27;2022100904&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> <span class="keyword">WITH</span> <span class="keyword">GRANT</span> OPTION;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SHOW</span> GRANTS <span class="keyword">FOR</span> <span class="string">&#x27;2022100904&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br></pre></td></tr></table></figure><h1 id="第5关-回收用户2022100904在mydata数据库中授予的-j-表-select权限">第5关 回收用户2022100904在mydata数据库中授予的 “J” 表 SELECT权限</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">REVOKE</span> <span class="keyword">SELECT</span> <span class="keyword">ON</span> mydata.J <span class="keyword">FROM</span> <span class="string">&#x27;2022100904&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SHOW</span> GRANTS <span class="keyword">FOR</span> <span class="string">&#x27;2022100904&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br></pre></td></tr></table></figure><h1 id="第6关-回收用户2022100904-2022100908在mydata数据库的中授予-的j表all-privileges权限">第6关 回收用户2022100904、2022100908在mydata数据库的中授予 的J表ALL PRIVILEGES权限</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line"></span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">REVOKE</span> <span class="keyword">ALL</span> <span class="keyword">ON</span> mydata.J <span class="keyword">FROM</span> <span class="string">&#x27;2022100904&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"><span class="keyword">REVOKE</span> <span class="keyword">ALL</span> <span class="keyword">ON</span> mydata.J <span class="keyword">FROM</span> <span class="string">&#x27;2022100908&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SHOW</span> GRANTS <span class="keyword">FOR</span> <span class="string">&#x27;2022100904&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"><span class="keyword">SHOW</span> GRANTS <span class="keyword">FOR</span> <span class="string">&#x27;2022100908&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br></pre></td></tr></table></figure><h1 id="第7关-回收用户2022100904在mydata数据中授予的-j-表update和insert的权限">第7关 回收用户2022100904在mydata数据中授予的“J”表UPDATE和INSERT的权限</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line"></span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">REVOKE</span> <span class="keyword">UPDATE</span>,<span class="keyword">INSERT</span> <span class="keyword">ON</span> mydata.J <span class="keyword">FROM</span> <span class="string">&#x27;2022100904&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SHOW</span> GRANTS <span class="keyword">FOR</span> <span class="string">&#x27;2022100904&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br></pre></td></tr></table></figure><h1 id="第8关-创建角色名为-r1的角色">第8关 创建角色名为 R1的角色</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">CREATE</span> ROLE <span class="string">&#x27;R1&#x27;</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SELECT</span> mysql.user.Host, mysql.user.User <span class="keyword">FROM</span> mysql.user <span class="keyword">WHERE</span> <span class="keyword">USER</span> <span class="operator">=</span> <span class="string">&#x27;R1&#x27;</span>;</span><br></pre></td></tr></table></figure><h1 id="第9关-给予创建的角色r1在mydata数据库中授予-j-表-的select-update-insert权限">第9关 给予创建的角色R1在mydata数据库中授予&quot;J&quot; 表 的SELECT 、UPDATE、INSERT权限</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line"></span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span>,<span class="keyword">UPDATE</span>,<span class="keyword">INSERT</span> <span class="keyword">ON</span> mydata.J <span class="keyword">TO</span> <span class="string">&#x27;R1&#x27;</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SHOW</span> GRANTS <span class="keyword">FOR</span> <span class="string">&#x27;R1&#x27;</span>;</span><br></pre></td></tr></table></figure><h1 id="第10关-给予创建的用户2022100904授予角色r1权限">第10关 给予创建的用户2022100904授予角色R1权限</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line"></span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">GRANT</span> <span class="string">&#x27;R1&#x27;</span> <span class="keyword">TO</span> <span class="string">&#x27;2022100904&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SHOW</span> GRANTS <span class="keyword">FOR</span> <span class="string">&#x27;2022100904&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br></pre></td></tr></table></figure><h1 id="第11关-给予已授权限的角色r1在mydata数据库中再次授予-j-表-的delete权限">第11关 给予已授权限的角色R1在mydata数据库中再次授予&quot;J&quot; 表 的DELETE权限</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line"></span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">DELETE</span> <span class="keyword">ON</span> mydata.J <span class="keyword">TO</span> <span class="string">&#x27;R1&#x27;</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SHOW</span> GRANTS <span class="keyword">FOR</span> <span class="string">&#x27;R1&#x27;</span>;</span><br></pre></td></tr></table></figure><h1 id="第12关-回收角色r1-对-j-表的-insert-权限">第12关 回收角色R1 对 J 表的 INSERT 权限</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">REVOKE</span> <span class="keyword">INSERT</span> <span class="keyword">ON</span> mydata.J <span class="keyword">FROM</span> <span class="string">&#x27;R1&#x27;</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SHOW</span> GRANTS <span class="keyword">FOR</span> <span class="string">&#x27;R1&#x27;</span>;</span><br></pre></td></tr></table></figure><h1 id="第13关-通过角色r1回收用户2022100904的被授予j表的select-update-insert权限">第13关 通过角色R1回收用户2022100904的被授予J表的SELECT 、UPDATE、INSERT权限</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line"></span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">REVOKE</span> <span class="string">&#x27;R1&#x27;</span> <span class="keyword">FROM</span> <span class="string">&#x27;2022100904&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SHOW</span> GRANTS <span class="keyword">FOR</span> <span class="string">&#x27;2022100904&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br></pre></td></tr></table></figure><h1 id="第14关-编写一个名为insert-s的触发器-在s表执行-insert-语句后被激发">第14关 编写一个名为INSERT_S的触发器，在S表执行 INSERT 语句后被激发</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line"></span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line">DELIMITER $$</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> INSERT_S</span><br><span class="line"> AFTER <span class="keyword">INSERT</span> <span class="keyword">ON</span> S</span><br><span class="line"> <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">INSERT INTO</span> N_S <span class="keyword">VALUES</span> (<span class="string">&#x27;S6&#x27;</span>, <span class="string">&#x27;深技大&#x27;</span>, <span class="string">&#x27;20&#x27;</span>, <span class="string">&#x27;深圳&#x27;</span>,<span class="string">&#x27;root@localhost&#x27;</span>);</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line">#将记录插入S表</span><br><span class="line"><span class="keyword">INSERT INTO</span> S <span class="keyword">VALUES</span> (<span class="string">&#x27;S6&#x27;</span>, <span class="string">&#x27;深技大&#x27;</span>, <span class="string">&#x27;20&#x27;</span>, <span class="string">&#x27;深圳&#x27;</span>);</span><br><span class="line">#查看N_S表</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> N_S;</span><br></pre></td></tr></table></figure><h1 id="第15关-编写一个名为update-s的触发器-检查s表的status-只允许0-100之间-如果超过100后-改为100">第15关 编写一个名为UPDATE_S的触发器，检查S表的STATUS，只允许0-100之间，如果超过100后，改为100。</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line"></span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line">DELIMITER $$</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> UPDATE_S</span><br><span class="line">BEFORE <span class="keyword">UPDATE</span> <span class="keyword">ON</span> S</span><br><span class="line"><span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">   IF(NEW.STATUS <span class="operator">&lt;</span><span class="number">0</span>) <span class="keyword">OR</span> (NEW.STATUS<span class="operator">&gt;</span><span class="number">100</span>)</span><br><span class="line">      <span class="keyword">THEN</span> <span class="keyword">SET</span> NEW.STATUS<span class="operator">=</span><span class="number">100</span>;</span><br><span class="line">   <span class="keyword">END</span> IF;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line">#更新S表</span><br><span class="line"><span class="keyword">UPDATE</span> S <span class="keyword">SET</span> S.STATUS <span class="operator">=</span> <span class="number">300</span> <span class="keyword">WHERE</span> S.CITY <span class="operator">=</span> <span class="string">&#x27;天津&#x27;</span>;</span><br><span class="line">#查看S表</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> S;</span><br></pre></td></tr></table></figure><h1 id="第16关-编写一个名为update-spj的触发器-spj表中有更新某条记录的qty时-自动更新表spj-sumqty表">第16关 编写一个名为UPDATE_SPJ的触发器，SPJ表中有更新某条记录的QTY时，自动更新表SPJ_SUMQTY表</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line"></span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line">DELIMITER $$</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> UPDATE_SPJ</span><br><span class="line">AFTER <span class="keyword">UPDATE</span> <span class="keyword">ON</span> SPJ</span><br><span class="line"><span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">UPDATE</span> SPJ_SUMQTY <span class="keyword">SET</span> SUMQTY <span class="operator">=</span> SUMQTY <span class="operator">+</span> NEW.QTY <span class="operator">-</span> OLD.QTY</span><br><span class="line">    <span class="keyword">WHERE</span> PNO <span class="operator">=</span> NEW.PNO <span class="keyword">AND</span> JNO <span class="operator">=</span> NEW.JNO;</span><br><span class="line"><span class="keyword">END</span> $$</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line">#更新SPJ表</span><br><span class="line"><span class="keyword">UPDATE</span> SPJ <span class="keyword">SET</span> SPJ.QTY <span class="operator">=</span> SPJ.QTY <span class="operator">+</span> <span class="number">200</span> <span class="keyword">WHERE</span> SPJ.JNO <span class="operator">=</span> <span class="string">&#x27;J5&#x27;</span>;</span><br><span class="line">#查看SPJ_SUMQTY表</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> SPJ_SUMQTY;</span><br></pre></td></tr></table></figure><h1 id="第17关-编写一个名为delete-spj的触发器-当spj表中有删除某条记录时-自动更新表spj-sumqty表">第17关 编写一个名为DELETE_SPJ的触发器，当SPJ表中有删除某条记录时，自动更新表SPJ_SUMQTY表</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line"></span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"></span><br><span class="line">DELIMITER $$</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> DELETE_SPJ</span><br><span class="line">AFTER <span class="keyword">DELETE</span> <span class="keyword">ON</span> SPJ</span><br><span class="line"><span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">UPDATE</span> SPJ_SUMQTY <span class="keyword">SET</span> SUMQTY <span class="operator">=</span> SUMQTY <span class="operator">-</span> OLD.QTY</span><br><span class="line">    <span class="keyword">WHERE</span> SPJ_SUMQTY.PNO <span class="operator">=</span> OLD.PNO <span class="keyword">AND</span> SPJ_SUMQTY.JNO <span class="operator">=</span> OLD.JNO;</span><br><span class="line">    <span class="keyword">DELETE</span> <span class="keyword">FROM</span> SPJ_SUMQTY <span class="keyword">WHERE</span> SPJ_SUMQTY.SUMQTY <span class="operator">&lt;=</span><span class="number">0</span>;</span><br><span class="line"><span class="keyword">END</span> $$</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line">#删除SPJ表的某条记录</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> SPJ <span class="keyword">WHERE</span> SPJ.SNO <span class="operator">=</span> <span class="string">&#x27;S2&#x27;</span> <span class="keyword">AND</span> SPJ.PNO <span class="operator">=</span> <span class="string">&#x27;P3&#x27;</span> <span class="keyword">AND</span> SPJ.JNO <span class="operator">=</span> <span class="string">&#x27;J5&#x27;</span>;</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> SPJ <span class="keyword">WHERE</span> SPJ.SNO <span class="operator">=</span> <span class="string">&#x27;S2&#x27;</span> <span class="keyword">AND</span> SPJ.PNO <span class="operator">=</span> <span class="string">&#x27;P3&#x27;</span> <span class="keyword">AND</span> SPJ.JNO <span class="operator">=</span> <span class="string">&#x27;J1&#x27;</span>;</span><br><span class="line">#查看SPJ_SUMQTY表</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> SPJ_SUMQTY;</span><br></pre></td></tr></table></figure><h1 id="第18关-编写一个名为insert-spj的触发器-当spj表中有插入某条记录时-自动更新表spj-sumqty表">第18关 编写一个名为INSERT_SPJ的触发器，当SPJ表中有插入某条记录时，自动更新表SPJ_SUMQTY表</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line"></span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line">DELIMITER $$</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> INSERT_SPJ</span><br><span class="line">AFTER <span class="keyword">INSERT</span> <span class="keyword">ON</span> SPJ</span><br><span class="line"><span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">UPDATE</span> SPJ_SUMQTY <span class="keyword">SET</span> SUMQTY <span class="operator">=</span> SUMQTY <span class="operator">+</span> NEW.QTY</span><br><span class="line">    <span class="keyword">WHERE</span> SPJ_SUMQTY.PNO <span class="operator">=</span> NEW.PNO <span class="keyword">AND</span> SPJ_SUMQTY.JNO <span class="operator">=</span>NEW.JNO;</span><br><span class="line">    IF NEW.JNO <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="keyword">SELECT</span> JNO <span class="keyword">FROM</span> SPJ_SUMQTY)</span><br><span class="line">    <span class="keyword">OR</span> NEW.PNO <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="keyword">SELECT</span> PNO <span class="keyword">FROM</span> SPJ_SUMQTY)</span><br><span class="line">        <span class="keyword">THEN</span> <span class="keyword">INSERT INTO</span> SPJ_SUMQTY <span class="keyword">VALUES</span> (NEW.JNO,NEW.PNO,NEW.QTY);</span><br><span class="line">    <span class="keyword">END</span> IF;</span><br><span class="line"><span class="keyword">END</span> $$</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line">#将记录插入SPJ表</span><br><span class="line"><span class="keyword">INSERT INTO</span> SPJ <span class="keyword">VALUES</span> (<span class="string">&#x27;S6&#x27;</span>, <span class="string">&#x27;P1&#x27;</span>, <span class="string">&#x27;J6&#x27;</span>, <span class="number">200</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> SPJ <span class="keyword">VALUES</span> (<span class="string">&#x27;S6&#x27;</span>, <span class="string">&#x27;P3&#x27;</span>, <span class="string">&#x27;J5&#x27;</span>, <span class="number">300</span>);</span><br><span class="line">#查看SPJ_SUMQTY表</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> SPJ_SUMQTY;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>实验14 数据库编程-2</title>
      <link href="/posts/3767/"/>
      <url>/posts/3767/</url>
      
        <content type="html"><![CDATA[<h1 id="第1关-定义一个名为proc-updategrade的存储过程">第1关 定义一个名为PROC_UPDATEGRADE的存储过程</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">USE myschool;</span><br><span class="line">#增加一列等级列</span><br><span class="line"><span class="keyword">ALTER TABLE</span> SC <span class="keyword">ADD</span> `rank` <span class="type">CHAR</span>(<span class="number">2</span>);</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">BEGIN</span> ##########</span><br><span class="line">DELIMITER $$</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> PROC_UPDATEGRADE()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">UPDATE</span> SC <span class="keyword">SET</span> rank <span class="operator">=</span> <span class="string">&#x27;A&#x27;</span> <span class="keyword">WHERE</span> Grade <span class="operator">&gt;=</span> <span class="number">90</span> <span class="keyword">AND</span> Grade <span class="operator">&lt;=</span> <span class="number">100</span>;</span><br><span class="line">    <span class="keyword">UPDATE</span> SC <span class="keyword">SET</span> rank <span class="operator">=</span> <span class="string">&#x27;B&#x27;</span> <span class="keyword">WHERE</span> Grade <span class="operator">&gt;=</span> <span class="number">80</span> <span class="keyword">AND</span> Grade <span class="operator">&lt;</span> <span class="number">90</span>;</span><br><span class="line">    <span class="keyword">UPDATE</span> SC <span class="keyword">SET</span> rank <span class="operator">=</span> <span class="string">&#x27;C&#x27;</span> <span class="keyword">WHERE</span> Grade <span class="operator">&gt;=</span> <span class="number">70</span> <span class="keyword">AND</span> Grade <span class="operator">&lt;</span> <span class="number">80</span>;</span><br><span class="line">    <span class="keyword">UPDATE</span> SC <span class="keyword">SET</span> rank <span class="operator">=</span> <span class="string">&#x27;D&#x27;</span> <span class="keyword">WHERE</span> Grade <span class="operator">&gt;=</span> <span class="number">60</span> <span class="keyword">AND</span> Grade <span class="operator">&lt;</span> <span class="number">70</span>;</span><br><span class="line">    <span class="keyword">UPDATE</span> SC <span class="keyword">SET</span> rank <span class="operator">=</span> <span class="string">&#x27;E&#x27;</span> <span class="keyword">WHERE</span> Grade <span class="operator">&gt;=</span> <span class="number">0</span> <span class="keyword">AND</span> Grade <span class="operator">&lt;</span> <span class="number">60</span>;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br><span class="line"><span class="keyword">CALL</span> PROC_UPDATEGRADE();</span><br><span class="line">########## <span class="keyword">END</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> SC;</span><br></pre></td></tr></table></figure><h1 id="第2关-使用游标定义一个名为proc-jgrade无参存储过程">第2关 使用游标定义一个名为PROC_JGRADE无参存储过程</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">BEGIN</span> ##########</span><br><span class="line">DELIMITER $$</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> PROC_JGRADE()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">DECLARE</span> PTYPE <span class="type">CHAR</span>(<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">DECLARE</span> NJNO <span class="type">CHAR</span>(<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">DECLARE</span> QTYTEMP <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">DECLARE</span> JNOTEMP <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">DECLARE</span> TEMP <span class="keyword">CURSOR</span> <span class="keyword">FOR</span></span><br><span class="line">    <span class="keyword">SELECT</span> JNO,<span class="built_in">SUM</span>(QTY)</span><br><span class="line">    <span class="keyword">FROM</span> SPJ</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> JNO</span><br><span class="line">    <span class="keyword">ORDER</span> <span class="keyword">BY</span> JNO <span class="keyword">ASC</span>;</span><br><span class="line">    <span class="keyword">OPEN</span> TEMP;</span><br><span class="line">    <span class="keyword">CREATE</span> TEMPORARY <span class="keyword">TABLE</span> temp_table(</span><br><span class="line">    SJNO <span class="type">CHAR</span>(<span class="number">10</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">    SQTY <span class="type">CHAR</span>(<span class="number">10</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">    JTYPE <span class="type">CHAR</span>(<span class="number">10</span>) <span class="keyword">NOT NULL</span></span><br><span class="line">    );</span><br><span class="line">    REPEAT</span><br><span class="line">    <span class="keyword">FETCH</span> TEMP <span class="keyword">INTO</span> NJNO,QTYTEMP;</span><br><span class="line">    IF(QTYTEMP<span class="operator">&lt;</span><span class="number">1000</span>)</span><br><span class="line">    <span class="keyword">THEN</span></span><br><span class="line">    <span class="keyword">SET</span> PTYPE<span class="operator">=</span><span class="string">&#x27;S&#x27;</span>;</span><br><span class="line">    ELSEIF(<span class="number">1000</span><span class="operator">&lt;=</span>QTYTEMP <span class="keyword">AND</span> QTYTEMP <span class="operator">&lt;=</span><span class="number">2000</span>)</span><br><span class="line">    <span class="keyword">THEN</span></span><br><span class="line">    <span class="keyword">SET</span> PTYPE<span class="operator">=</span><span class="string">&#x27;M&#x27;</span>;</span><br><span class="line">    ELSEIF(QTYTEMP<span class="operator">&gt;</span><span class="number">2000</span>)</span><br><span class="line">    <span class="keyword">THEN</span></span><br><span class="line">    <span class="keyword">SET</span> PTYPE<span class="operator">=</span><span class="string">&#x27;L&#x27;</span>;</span><br><span class="line">    <span class="keyword">END</span> IF;</span><br><span class="line">    <span class="keyword">INSERT INTO</span> temp_table <span class="keyword">VALUES</span>(NJNO,QTYTEMP,PTYPE);</span><br><span class="line">    <span class="keyword">SET</span> JNOTEMP <span class="operator">=</span>JNOTEMP<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line">    UNTIL JNOTEMP<span class="operator">&gt;=</span><span class="number">5</span></span><br><span class="line">    <span class="keyword">END</span> REPEAT;</span><br><span class="line">    <span class="keyword">CLOSE</span> TEMP;</span><br><span class="line">    <span class="keyword">SELECT</span><span class="operator">*</span><span class="keyword">FROM</span> temp_table;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br><span class="line">########## <span class="keyword">END</span> ##########</span><br><span class="line"># 以下代码禁止删除</span><br><span class="line"><span class="keyword">CALL</span> PROC_JGRADE();</span><br></pre></td></tr></table></figure><h1 id="第3关-使用游标定义一个名为proc-numgrade有参存储过程">第3关 使用游标定义一个名为PROC_NUMGRADE有参存储过程</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">USE myschool;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">BEGIN</span> ##########</span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> proc_numgrade(<span class="keyword">IN</span> sumtemp <span class="type">CHAR</span>(<span class="number">9</span>))</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">DECLARE</span> a <span class="type">INT</span>;</span><br><span class="line">    <span class="keyword">DECLARE</span> b <span class="type">INT</span> <span class="keyword">default</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">DECLARE</span> c <span class="keyword">cursor</span> <span class="keyword">for</span></span><br><span class="line">    <span class="keyword">SELECT</span> Grade</span><br><span class="line">    <span class="keyword">FROM</span> Course,SC</span><br><span class="line">    <span class="keyword">WHERE</span> Cname <span class="operator">=</span> sumtemp <span class="keyword">AND</span> Course.Cno <span class="operator">=</span> SC.Cno;</span><br><span class="line">    <span class="keyword">DECLARE</span> contINue handler <span class="keyword">for</span> <span class="keyword">not</span> found <span class="keyword">SET</span> b <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">CREATE</span> temporary <span class="keyword">table</span> TMEP_TABLE(</span><br><span class="line">        Type <span class="type">CHAR</span>(<span class="number">30</span>),</span><br><span class="line">        Num <span class="type">INT</span></span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">INSERT INTO</span> TMEP_TABLE <span class="keyword">VALUES</span>(<span class="string">&#x27;100&#x27;</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">INSERT INTO</span> TMEP_TABLE <span class="keyword">VALUES</span>(<span class="string">&#x27;[90,100)&#x27;</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">INSERT INTO</span> TMEP_TABLE <span class="keyword">VALUES</span>(<span class="string">&#x27;[80,90)&#x27;</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">INSERT INTO</span> TMEP_TABLE <span class="keyword">VALUES</span>(<span class="string">&#x27;[70,80)&#x27;</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">INSERT INTO</span> TMEP_TABLE <span class="keyword">VALUES</span>(<span class="string">&#x27;[60,70)&#x27;</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">INSERT INTO</span> TMEP_TABLE <span class="keyword">VALUES</span>(<span class="string">&#x27;[0,60)&#x27;</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">OPEN</span> c;</span><br><span class="line">    WHILE b <span class="operator">!=</span> <span class="number">1</span> do</span><br><span class="line">        <span class="keyword">FETCH</span> c <span class="keyword">INTO</span> a;</span><br><span class="line">        IF b <span class="operator">!=</span> <span class="number">1</span> <span class="keyword">THEN</span></span><br><span class="line">            IF a<span class="operator">=</span><span class="number">100</span> <span class="keyword">THEN</span> <span class="keyword">UPDATE</span> TMEP_TABLE <span class="keyword">SET</span> Num<span class="operator">=</span>Num<span class="operator">+</span><span class="number">1</span> <span class="keyword">WHERE</span> Type<span class="operator">=</span><span class="string">&#x27;100&#x27;</span>;</span><br><span class="line">            ELSEIF a<span class="operator">&gt;=</span><span class="number">90</span> <span class="keyword">AND</span> a<span class="operator">&lt;</span><span class="number">100</span> <span class="keyword">THEN</span> <span class="keyword">UPDATE</span> TMEP_TABLE <span class="keyword">SET</span> Num<span class="operator">=</span>Num<span class="operator">+</span><span class="number">1</span> <span class="keyword">WHERE</span> Type<span class="operator">=</span><span class="string">&#x27;[90,100)&#x27;</span>;</span><br><span class="line">            ELSEIF a<span class="operator">&gt;=</span><span class="number">80</span> <span class="keyword">AND</span> a<span class="operator">&lt;</span><span class="number">90</span> <span class="keyword">THEN</span> <span class="keyword">UPDATE</span> TMEP_TABLE <span class="keyword">SET</span> Num<span class="operator">=</span>Num<span class="operator">+</span><span class="number">1</span> <span class="keyword">WHERE</span> Type<span class="operator">=</span><span class="string">&#x27;[80,90)&#x27;</span>;</span><br><span class="line">            ELSEIF a<span class="operator">&gt;=</span><span class="number">70</span> <span class="keyword">AND</span> a<span class="operator">&lt;</span><span class="number">80</span> <span class="keyword">THEN</span> <span class="keyword">UPDATE</span> TMEP_TABLE <span class="keyword">SET</span> Num<span class="operator">=</span>Num<span class="operator">+</span><span class="number">1</span> <span class="keyword">WHERE</span> Type<span class="operator">=</span><span class="string">&#x27;[70,80)&#x27;</span>;</span><br><span class="line">            ELSEIF a<span class="operator">&gt;=</span><span class="number">60</span> <span class="keyword">AND</span> a<span class="operator">&lt;</span><span class="number">70</span> <span class="keyword">THEN</span> <span class="keyword">UPDATE</span> TMEP_TABLE <span class="keyword">SET</span> Num<span class="operator">=</span>Num<span class="operator">+</span><span class="number">1</span> <span class="keyword">WHERE</span> Type<span class="operator">=</span><span class="string">&#x27;[60,70)&#x27;</span>;</span><br><span class="line">            ELSEIF a<span class="operator">&gt;=</span><span class="number">0</span> <span class="keyword">AND</span> a<span class="operator">&lt;</span><span class="number">60</span> <span class="keyword">THEN</span> <span class="keyword">UPDATE</span> TMEP_TABLE <span class="keyword">SET</span> Num<span class="operator">=</span>Num<span class="operator">+</span><span class="number">1</span> <span class="keyword">WHERE</span> Type<span class="operator">=</span><span class="string">&#x27;[0,60)&#x27;</span>;</span><br><span class="line">            <span class="keyword">END</span> IF;  </span><br><span class="line">        <span class="keyword">END</span> IF;</span><br><span class="line">    <span class="keyword">END</span> WHILE;</span><br><span class="line">    <span class="keyword">CLOSE</span> c;</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> TMEP_TABLE;</span><br><span class="line"><span class="keyword">END</span>;$</span><br><span class="line">DELIMITER ;</span><br><span class="line">########## <span class="keyword">END</span> ##########</span><br><span class="line"># 以下代码禁止删除</span><br><span class="line"><span class="keyword">CALL</span> PROC_NUMGRADE(<span class="string">&#x27;离散数学&#x27;</span>);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>实验13 数据库编程-1</title>
      <link href="/posts/31554/"/>
      <url>/posts/31554/</url>
      
        <content type="html"><![CDATA[<h1 id="第1关-定义一个名为proc-count的无参数存储过程">第1关 定义一个名为PROC_COUNT的无参数存储过程</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> PROC_COUNT()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line">    <span class="keyword">FROM</span> J</span><br><span class="line">    <span class="keyword">WHERE</span> JNAME <span class="keyword">LIKE</span> &quot;%厂%&quot;;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> PROC_COUNT()</span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第2关-定义一个名为proc-jname的有参数存储过程">第2关 定义一个名为PROC_JNAME的有参数存储过程</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> PROC_JNAME(<span class="keyword">IN</span> city <span class="type">CHAR</span>(<span class="number">2</span>))</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SELECT</span> JNAME</span><br><span class="line">    <span class="keyword">FROM</span> J</span><br><span class="line">    <span class="keyword">WHERE</span> J.CITY <span class="operator">=</span> city;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">CALL</span> PROC_JNAME(<span class="string">&#x27;天津&#x27;</span>);</span><br></pre></td></tr></table></figure><h1 id="第3关-定义一个名为proc-jinfo的有参数存储过程">第3关 定义一个名为PROC_JINFO的有参数存储过程</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> PROC_JINFO(<span class="keyword">IN</span> city <span class="type">CHAR</span>(<span class="number">2</span>))</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SELECT</span></span><br><span class="line">        JNAME,</span><br><span class="line">        PNAME,</span><br><span class="line">        <span class="built_in">SUM</span>(QTY) SUM_QTY</span><br><span class="line">    <span class="keyword">FROM</span> SPJ</span><br><span class="line">    <span class="keyword">JOIN</span> P <span class="keyword">USING</span>(PNO)</span><br><span class="line">    <span class="keyword">JOIN</span> J <span class="keyword">USING</span>(JNO)</span><br><span class="line">    <span class="keyword">WHERE</span> J.CITY <span class="operator">=</span> city</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> JNAME,PNAME</span><br><span class="line">    <span class="keyword">ORDER</span> <span class="keyword">BY</span> JNAME,PNAME;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line">DELIMITER ;</span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">CALL</span> PROC_JINFO(<span class="string">&#x27;天津&#x27;</span>);</span><br></pre></td></tr></table></figure><h1 id="第4关-定义一个名为proc-avggrade的有参数存储过程">第4关 定义一个名为PROC_AVGGRADE的有参数存储过程</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">USE myschool;</span><br><span class="line"></span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> PROC_AVGGRADE(<span class="keyword">IN</span> name <span class="type">CHAR</span>(<span class="number">9</span>))</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SELECT</span></span><br><span class="line">        <span class="built_in">AVG</span>(Grade) AVG_Grade</span><br><span class="line">    <span class="keyword">FROM</span> SC</span><br><span class="line">    <span class="keyword">JOIN</span> Course <span class="keyword">USING</span>(Cno)</span><br><span class="line">    <span class="keyword">WHERE</span> Cname <span class="operator">=</span> name;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line"># 以下代码禁止删除</span><br><span class="line"><span class="keyword">CALL</span> PROC_AVGGRADE(<span class="string">&#x27;数据库&#x27;</span>);</span><br></pre></td></tr></table></figure><h1 id="第5关-定义一个名为proc-sinfo的有参数存储过程">第5关 定义一个名为PROC_SINFO的有参数存储过程</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line"></span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> PROC_SINFO(<span class="keyword">IN</span> name <span class="type">CHAR</span>(<span class="number">10</span>))</span><br><span class="line"><span class="keyword">BEGIN</span>  </span><br><span class="line">    <span class="keyword">SELECT</span></span><br><span class="line">        JNAME,</span><br><span class="line">        PNAME,</span><br><span class="line">        <span class="built_in">SUM</span>(QTY) SUM_QTY</span><br><span class="line">    <span class="keyword">FROM</span> SPJ</span><br><span class="line">    <span class="keyword">JOIN</span> S <span class="keyword">USING</span>(SNO)</span><br><span class="line">    <span class="keyword">JOIN</span> P <span class="keyword">USING</span>(PNO)</span><br><span class="line">    <span class="keyword">JOIN</span> J <span class="keyword">USING</span>(JNO)</span><br><span class="line">    <span class="keyword">WHERE</span> SNAME <span class="operator">=</span> name</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> JNAME,PNAME</span><br><span class="line">    <span class="keyword">ORDER</span> <span class="keyword">BY</span> JNAME,PNAME;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">CALL</span> PROC_SINFO(<span class="string">&#x27;精益&#x27;</span>);</span><br></pre></td></tr></table></figure><h1 id="第6关-定义一个名为proc-jsearch的有参数存储过程">第6关 定义一个名为PROC_JSEARCH的有参数存储过程</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line"></span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> PROC_JSEARCH(<span class="keyword">IN</span> <span class="keyword">no</span> <span class="type">CHAR</span>(<span class="number">2</span>))</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SELECT</span></span><br><span class="line">        SNAME,</span><br><span class="line">        PNAME,</span><br><span class="line">        JNAME</span><br><span class="line">    <span class="keyword">FROM</span> SPJ</span><br><span class="line">    <span class="keyword">JOIN</span> S <span class="keyword">USING</span>(SNO)</span><br><span class="line">    <span class="keyword">JOIN</span> P <span class="keyword">USING</span>(PNO)</span><br><span class="line">    <span class="keyword">JOIN</span> J <span class="keyword">USING</span>(JNO)</span><br><span class="line">    <span class="keyword">WHERE</span> SPJ.JNO <span class="operator">=</span> <span class="keyword">no</span></span><br><span class="line">    <span class="keyword">ORDER</span> <span class="keyword">BY</span> SNAME,PNAME;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">CALL</span> PROC_JSEARCH(<span class="string">&#x27;J2&#x27;</span>);</span><br></pre></td></tr></table></figure><h1 id="第7关-定义一个名为proc-supdate的有参数存储过程">第7关 定义一个名为PROC_SUPDATE的有参数存储过程</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line"></span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> PROC_SUPDATE(<span class="keyword">no</span> <span class="type">CHAR</span>(<span class="number">3</span>),name <span class="type">CHAR</span>(<span class="number">10</span>),city <span class="type">CHAR</span>(<span class="number">10</span>))</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">UPDATE</span> S</span><br><span class="line">    <span class="keyword">SET</span> SNAME <span class="operator">=</span> name,</span><br><span class="line">        CITY <span class="operator">=</span> city</span><br><span class="line">    <span class="keyword">WHERE</span> SNO <span class="operator">=</span> <span class="keyword">no</span>;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">CALL</span> PROC_SUPDATE(<span class="string">&#x27;S4&#x27;</span>, <span class="string">&#x27;深技大&#x27;</span>, <span class="string">&#x27;深圳&#x27;</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> S;</span><br></pre></td></tr></table></figure><h1 id="第8关-定义一个名为proc-avgweight的有参数存储过程">第8关 定义一个名为PROC_AVGWEIGHT的有参数存储过程</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> PROC_AVGWEIGHT(<span class="keyword">IN</span> sno <span class="type">CHAR</span>(<span class="number">3</span>),<span class="keyword">IN</span> jno <span class="type">CHAR</span>(<span class="number">3</span>),<span class="keyword">OUT</span> AVG_WEIGHT <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SELECT</span></span><br><span class="line">        <span class="built_in">SUM</span>(WEIGHT<span class="operator">*</span>QTY)<span class="operator">/</span><span class="built_in">SUM</span>(QTY)</span><br><span class="line">    <span class="keyword">INTO</span> AVG_WEIGHT</span><br><span class="line">    <span class="keyword">FROM</span> SPJ</span><br><span class="line">    <span class="keyword">JOIN</span> P <span class="keyword">USING</span>(PNO)</span><br><span class="line">    <span class="keyword">WHERE</span> SPJ.SNO <span class="operator">=</span> sno <span class="keyword">AND</span> SPJ.JNO <span class="operator">=</span> jno</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> SPJ.SNO,SPJ.JNO;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line"><span class="keyword">CALL</span> PROC_AVGWEIGHT(<span class="string">&#x27;S2&#x27;</span>,<span class="string">&#x27;J2&#x27;</span>,<span class="variable">@AVG_WEIGHT</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@AVG_WEIGHT</span>;</span><br></pre></td></tr></table></figure><h1 id="第9关-定义一个名为proc-jgrade的有参数存储过程">第9关 定义一个名为PROC_JGRADE的有参数存储过程</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> PROC_JGRADE(<span class="keyword">IN</span> jno <span class="type">CHAR</span>(<span class="number">3</span>),<span class="keyword">OUT</span> JTYPE <span class="type">CHAR</span>(<span class="number">1</span>))</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SELECT</span></span><br><span class="line">        <span class="keyword">CASE</span></span><br><span class="line">            <span class="keyword">WHEN</span> <span class="built_in">SUM</span>(QTY) <span class="operator">&gt;</span> <span class="number">2000</span> <span class="keyword">THEN</span> <span class="string">&#x27;L&#x27;</span></span><br><span class="line">            <span class="keyword">WHEN</span> <span class="built_in">SUM</span>(QTY) <span class="keyword">BETWEEN</span> <span class="number">1000</span> <span class="keyword">AND</span> <span class="number">2000</span> <span class="keyword">THEN</span> <span class="string">&#x27;M&#x27;</span></span><br><span class="line">            <span class="keyword">ELSE</span> <span class="string">&#x27;S&#x27;</span></span><br><span class="line">        <span class="keyword">END</span>  type</span><br><span class="line">        <span class="keyword">INTO</span> JTYPE</span><br><span class="line">    <span class="keyword">FROM</span> SPJ</span><br><span class="line">    <span class="keyword">WHERE</span> SPJ.JNO <span class="operator">=</span> jno;</span><br><span class="line"><span class="keyword">END</span>$</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">CALL</span> PROC_JGRADE(<span class="string">&#x27;J1&#x27;</span>, <span class="variable">@JTYPE</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@JTYPE</span>;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>实验12 数据库E-R图设计</title>
      <link href="/posts/973/"/>
      <url>/posts/973/</url>
      
        <content type="html"><![CDATA[<p>1、注意事项：<br>1)、先完成实体的关系模型(表)，确定实体的主码(尽量单列做主码)<br>2)、联系的转换：<br>①1:1的联系<br>联系合并到某个1端，并在该表中增加另一个实体的码(作为外码，不作为主属性！)，以及添加联系本身的属性。<br>② 1:n的联系<br>合并到n端对应的表中，将1端的码添加到n端的表(作为外码，不作为主属性！)，以及添加联系本身的属性。<br>③m:n的联系<br>必须增加一个新表，新表的码至少由联系两端实体的码组合而成，同时增加相关的联系属性(如有时间等辅助标识唯一属性，一般应作为主属性)。</p><p>3)、课本P232，1：1，1：n联系时，把转换新的关系模式打叉，以后工作时除非很特殊的场景，都不要转换为新的表。ER图的设计虽然理论上是最简关系，但关系型数据库的缺点之一就是表相对较多，多表查询可能时延较大，商用时还可能根据性能降低范式合表（只要业务模型能规避低范式的增删改问题即可）。</p><p>4）注意事项：<strong>取决于业务建模</strong><br><strong>①</strong> <strong>联系需要有意义，而不仅是取值约束</strong><br><strong>②</strong> <strong>联系可能需要新增时间等主属性</strong><br><strong>③</strong> <strong>两个实体之间可能存在多种联系</strong><br><strong>④</strong> <strong>三元联系之外，依然可能存在两两间联系</strong><br><strong>⑤</strong> <strong>联系可以再与实体或联系产生联系</strong><br><strong>⑥</strong> <strong>通过编号规则可增加信息量，减少主属性</strong><br><strong>⑦</strong> <strong>有时通过完整性约束(比如触发器)可约束取值，不一定要通过表来约束</strong></p><p><strong>题目1：</strong><br>某医院病房信息系统中需要如下数据信息：<br>科室：科地址，科名(不重复)，科电话<br>病房：床位数量，病房号<br>医生：姓名，职称，性别，工号<br>病人：姓名，病历号，性别</p><p>其中，一个科室有多个病房、多个医生，一个病房只能属于一个科室，一个医生只属于一个科室，但可负责多个病人的诊治(简化，只考虑每人一次诊断)，一个病人入住病房后（一个病房可能住多名病人）的主管医生只有一个。<em>(注：题目特意未描述医生与病房的联系，请按题意作答。因此分组综合实验宣讲时，都必须讲E-R图的设计，自然语言描述数据库设计容易二义性。)</em><br>完成如下设计：<br>（1）设计该信息系统的E－R图；（20分）<br><img src="https://raw.githubusercontent.com/crayz-l/Learning_picgo/main/img/sql_experiment12_1" alt=""></p><p>（2）将该E-R图转换为关系模型结构，注明每个关系模式的主码(下划线)和外码(可用FK标注)，是否满足BCNF。（10分）<br>科室（<u>科名</u>，科地址，科电话）<br>病房（<u>病房号</u>，床位数量，科名（FK））<br>医生（<u>工号</u>，姓名，职称，性别，科名（FK））<br>病人（<u>病历号</u>，姓名，性别，病房号（FK），主管医生工号（FK））<br>没有任何部分码依赖、传递依赖、或非主属性到主码的依赖，所以均满足BCNF。</p><p>（3）假设病人可以看多个医生(同一个医生也可以看<strong>多</strong>次)，那么是否需要新建表？请仅写出该新建的表，其他不用写。标注主码(下划线)和外码(可用FK标注)。（10分）<br>诊断（<u>医生工号（FK）</u>，<u>病历号（FK）</u>，<u>诊断时间</u>，诊断）</p><p><strong>题目2：</strong><br>某工厂信息系统需如下数据信息，集团有多个工厂，每间工厂可生产多种产品，且每种产品可以在多间工厂生产，每间工厂需记录生产产品的<strong>该月产量</strong>；每间工厂聘用多名职工，且每名职工只能在一间工厂工作，工厂聘用职工有聘期和工资。工厂的属性有厂名、工厂编号、地址，产品的属性有产品名、产品编号、规格，职工的属性有职工号、姓名。<br>（1）根据上述语义画出E-R图，要求画出属性；（15分）<br><img src="https://raw.githubusercontent.com/crayz-l/Learning_picgo/main/img/sql_experiment12_2" alt=""><br>（2）将该E-R模型转换为关系模型，指出每个关系模式的主码(下划线)和外码(可用FK标注)，以及是否满足BCNF。（15分）<br>工厂（<u>工厂编号</u>，厂名，地址）满足BCNF;<br>产品（<u>产品编号</u>，产品名，规格）满足BCNF；<br>职工（<u>职工号</u>，姓名，聘期，工资，工厂编号（FK））满足BCNF；<br>生产记录（<u>工厂编号（FK）</u>，<u>产品编号（FK）</u>，生产年月，月产量）满足BCNF。<br>由于记录月产量肯定需要按月份划分，所以在生产记录表中引入生产年月这一属性。</p><p><strong>题目3：</strong><br>某高校设计的数据库需设计如下属性列：<br>①   首先课程号、准考证号均为唯一，请根据下表的列名确定对应属性列；<em>(提示：唯一即能够标识一个实体，先读完题目，然后根据下表排除后的列名找出课程号、准考证号能唯一确定的列。此外，本题特意不用学号)；</em><br>②   教室号和考试时间(含日期时间)决定唯一的考场，每门课可以有多个考场(而一个考场在某考试时间只能考一门课)；一人可以考多门课(不同学期可以考同一门课)；<br>③   缓考情况里比如缓考/休学需记录在该学期的该次选课里，成绩为空；<br><strong>请根据题干作答，</strong> 其他语义不再赘述 <em>(题目并未给出很详细的信息，但可以按题意给出唯一参考答案。)</em></p><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><td>准考证号</td><td>姓名</td><td>教室号</td><td>考试时间</td><td>主监考工号</td><td>座位号</td><td>缓考情况</td><td>考试成绩</td><td>考试成绩</td><td>考试成绩</td><td>考试成绩</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>课程号</td><td>课程名</td><td>学期</td><td>成绩</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>缓考/休学/缺考…</td><td></td><td></td><td>2022-1</td><td></td></tr></tbody></table><p>(1)请回答以上关系是否满足3NF？是否满足2NF？<br>由题目可知，在考试成绩一列还可细分，不满足1NF，故不满足3NF和2NF</p><p>(2)若不满足，请将其转化为符合3NF，表名自定，不要增删属性，注明主码(下划线)和外码(用FK标注)。<em>提示：用E-R图思想比列举函数依赖关系往往更直观，尤其商用需要描述上百个属性时。</em><br>学生信息（<u>准考证号</u>，姓名）<br>课程信息（<u>课程号</u>，课程名）<br>考场信息（<u>教室号</u>，<u>考试时间</u>，课程号（FK），主监考工号）<br>考场座位（<u>准考证号（FK）</u>，<u>教室号（FK）</u>，<u>考试时间</u>，座位号）<br>考试成绩（<u>准考证号（FK）</u>，<u>课程号（FK）</u>，<u>学期</u>，<u>缓考情况</u>，成绩）</p>]]></content>
      
      
      <categories>
          
          <category> 题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>实验11 SQL互联网业务查询-2</title>
      <link href="/posts/21532/"/>
      <url>/posts/21532/</url>
      
        <content type="html"><![CDATA[<h1 id="第1关-查询某网站每个日期新用户的次日留存率">第1关 查询某网站每个日期新用户的次日留存率</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">with</span> Table_a <span class="keyword">as</span>(</span><br><span class="line">    <span class="keyword">SELECT</span></span><br><span class="line">        user_id,</span><br><span class="line">        <span class="built_in">MIN</span>(<span class="type">date</span>) <span class="type">date</span></span><br><span class="line">    <span class="keyword">FROM</span> login</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> user_id</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    Table_a.date,</span><br><span class="line">    ROUND (<span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> login.user_id)<span class="operator">/</span><span class="built_in">COUNT</span>(Table_a.user_id),<span class="number">3</span>) p</span><br><span class="line"><span class="keyword">FROM</span> Table_a</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> login <span class="keyword">ON</span> Table_a.user_id <span class="operator">=</span> login.user_id <span class="keyword">AND</span> DATEDIFF(login.date,Table_a.date) <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> Table_a.date</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    login.date,</span><br><span class="line">    <span class="number">0.000</span></span><br><span class="line"><span class="keyword">FROM</span> login</span><br><span class="line"><span class="keyword">WHERE</span> <span class="type">date</span> <span class="keyword">NOT</span> <span class="keyword">IN</span>(</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="type">date</span></span><br><span class="line">    <span class="keyword">FROM</span> Table_a</span><br><span class="line">)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="type">date</span></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第2关-查询满足条件的用户">第2关 查询满足条件的用户</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line"></span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    user_id,</span><br><span class="line">    <span class="built_in">MIN</span>(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> num <span class="operator">=</span> <span class="number">1</span> <span class="keyword">THEN</span> <span class="type">date</span> <span class="keyword">END</span>) first_buy_date,</span><br><span class="line">    <span class="built_in">MAX</span>(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> num <span class="operator">=</span> <span class="number">2</span> <span class="keyword">THEN</span> <span class="type">date</span> <span class="keyword">END</span>) second_buy_date,</span><br><span class="line">    <span class="built_in">COUNT</span>(<span class="operator">*</span>) cnt</span><br><span class="line"><span class="keyword">FROM</span> (</span><br><span class="line">    <span class="keyword">SELECT</span></span><br><span class="line">        <span class="operator">*</span>,</span><br><span class="line">        <span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> user_id <span class="keyword">order</span> <span class="keyword">by</span> <span class="type">date</span>) num</span><br><span class="line">    <span class="keyword">FROM</span> order_info</span><br><span class="line">    <span class="keyword">WHERE</span> status <span class="operator">=</span> <span class="string">&#x27;completed&#x27;</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="type">date</span> <span class="operator">&gt;</span> <span class="string">&#x27;2021-10-15&#x27;</span></span><br><span class="line">    <span class="keyword">AND</span> product_name <span class="keyword">IN</span> (<span class="string">&#x27;C++&#x27;</span>,<span class="string">&#x27;Python&#x27;</span>,<span class="string">&#x27;Java&#x27;</span>)</span><br><span class="line">) a</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> user_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="number">1</span>)<span class="operator">&gt;=</span><span class="number">2</span></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第3关-查询未完成订单率排名前三的用户">第3关 查询未完成订单率排名前三的用户</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    product_name,</span><br><span class="line">    user_id,</span><br><span class="line">    rnk,</span><br><span class="line">    CONCAT(FORMAT(incomp_rate<span class="operator">*</span><span class="number">100</span>, <span class="number">2</span>), <span class="string">&#x27;%&#x27;</span>) incomp_rate</span><br><span class="line"><span class="keyword">FROM</span>(</span><br><span class="line">    <span class="keyword">SELECT</span></span><br><span class="line">        product_name,</span><br><span class="line">        user_id,</span><br><span class="line">        <span class="built_in">DENSE_RANK</span>() <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> product_name <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">SUM</span>(IF(status <span class="operator">=</span> <span class="string">&#x27;no_completed&#x27;</span>,<span class="number">1</span>,<span class="number">0</span>)) <span class="operator">/</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">DESC</span>)  rnk,</span><br><span class="line">        ROUND(<span class="built_in">SUM</span>(IF(status <span class="operator">=</span> <span class="string">&#x27;no_completed&#x27;</span>,<span class="number">1</span>,<span class="number">0</span>))<span class="operator">/</span><span class="built_in">COUNT</span>(<span class="operator">*</span>),<span class="number">4</span>) incomp_rate</span><br><span class="line">    <span class="keyword">FROM</span> order_info</span><br><span class="line">    <span class="keyword">WHERE</span> <span class="type">date</span> <span class="keyword">BETWEEN</span> <span class="string">&#x27;2021-10-16&#x27;</span> <span class="keyword">AND</span> <span class="string">&#x27;2021-10-31&#x27;</span></span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> product_name,user_id</span><br><span class="line">    <span class="keyword">HAVING</span> incomp_rate <span class="operator">&gt;</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">ORDER</span> <span class="keyword">BY</span> product_name,rnk</span><br><span class="line">) a</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> product_name,user_id</span><br><span class="line"><span class="keyword">HAVING</span> rnk <span class="operator">&lt;=</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>实验10 SQL互联网业务查询-1</title>
      <link href="/posts/54623/"/>
      <url>/posts/54623/</url>
      
        <content type="html"><![CDATA[<h1 id="第1关-查找购买个数超过20-重量小于50的商品-按照商品id升序排序">第1关 查找购买个数超过20,重量小于50的商品，按照商品id升序排序</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">USE mygoods;</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> G.id,<span class="built_in">SUM</span>(T.count) total</span><br><span class="line"><span class="keyword">FROM</span> goods G</span><br><span class="line"><span class="keyword">JOIN</span> trans T <span class="keyword">USING</span>(id)</span><br><span class="line"><span class="keyword">WHERE</span> weight <span class="operator">&lt;</span> <span class="number">50</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> T.id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">SUM</span>(T.count)<span class="operator">&gt;</span><span class="number">20</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> G.id;</span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第2关-查询向follow表中user-id-1-的用户-推荐其关注的人喜欢的音乐">第2关 查询向follow表中user_id = 1 的用户，推荐其关注的人喜欢的音乐</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">USE mymusic;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> music_name</span><br><span class="line"><span class="keyword">FROM</span> music</span><br><span class="line"><span class="keyword">WHERE</span> id <span class="keyword">IN</span>(</span><br><span class="line">    <span class="keyword">SELECT</span> music_id</span><br><span class="line">    <span class="keyword">FROM</span> music_likes mi,follow f</span><br><span class="line">    <span class="keyword">WHERE</span> mi.user_id <span class="operator">=</span> f.follower_id <span class="keyword">AND</span> f.user_id <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">AND</span> music_id <span class="keyword">NOT</span> <span class="keyword">IN</span>(</span><br><span class="line">        <span class="keyword">SELECT</span> music_id</span><br><span class="line">        <span class="keyword">FROM</span> music_likes mi</span><br><span class="line">        <span class="keyword">WHERE</span> user_id <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">    )</span><br><span class="line">)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> music_name</span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第3关-查询向follow表中user-id用户-推荐其关注的人喜欢的音乐">第3关 查询向follow表中user_id用户，推荐其关注的人喜欢的音乐</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">USE mymusic;</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> f.user_id,music_name</span><br><span class="line"><span class="keyword">FROM</span> music_likes mi</span><br><span class="line"><span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> follow f <span class="keyword">ON</span> f.follower_id <span class="operator">=</span> mi.user_id</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> music m <span class="keyword">ON</span> mi.music_id <span class="operator">=</span> m.id</span><br><span class="line"><span class="keyword">WHERE</span> music_id <span class="keyword">NOT</span> <span class="keyword">IN</span>(</span><br><span class="line">    <span class="keyword">SELECT</span> music_id</span><br><span class="line">    <span class="keyword">FROM</span> (</span><br><span class="line">        <span class="keyword">SELECT</span> Tablea.<span class="operator">*</span></span><br><span class="line">        <span class="keyword">FROM</span> (</span><br><span class="line">            <span class="keyword">SELECT</span></span><br><span class="line">            mi1.<span class="operator">*</span>,</span><br><span class="line">            f1.follower_id</span><br><span class="line">            <span class="keyword">FROM</span> follow f1,music_likes mi1</span><br><span class="line">            <span class="keyword">WHERE</span> f1.user_id <span class="operator">=</span> mi1.user_id</span><br><span class="line">        ) Tablea,music_likes mi2</span><br><span class="line">        <span class="keyword">WHERE</span> Tablea.follower_id <span class="operator">=</span> mi2.user_id <span class="keyword">AND</span> Tablea.music_id <span class="operator">=</span> mi2.music_id</span><br><span class="line">    ) Tableb</span><br><span class="line">)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> user_id,music_name</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第4关-查询用户日活数及支付金额">第4关 查询用户日活数及支付金额</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">USE myusers;</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">   lr.dt,</span><br><span class="line">   <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> lr.user_id) dau,</span><br><span class="line">   <span class="built_in">SUM</span>(nu.is_new) dau_new,</span><br><span class="line">   <span class="built_in">SUM</span>(up.pay_money) total_pay,</span><br><span class="line">   <span class="built_in">SUM</span>(IF(nu.is_new<span class="operator">=</span><span class="number">1</span>,up.pay_money,<span class="keyword">NULL</span>)) total_pay_new</span><br><span class="line"><span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> user_id,dt <span class="keyword">FROM</span> login_record) lr</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> new_user nu <span class="keyword">ON</span> lr.user_id <span class="operator">=</span> nu.user_id</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> user_pay up <span class="keyword">ON</span> lr.user_id <span class="operator">=</span> up.user_id <span class="keyword">AND</span> lr.dt <span class="operator">=</span> up.dt</span><br><span class="line"></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> lr.dt</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">SUM</span>(up.pay_money) <span class="keyword">IS</span> <span class="keyword">NOT NULL</span></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第5关-查询各工程号最大的按零件号合计供应量以及该零件号-并先按工程号升序-再按零件号升序排序">第5关 查询各工程号最大的按零件号合计供应量以及该零件号，并先按工程号升序，再按零件号升序排序。</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> JNO,PNO,SUM_QTY maxsum</span><br><span class="line"><span class="keyword">FROM</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> JNO,PNO,<span class="built_in">SUM</span>(QTY) SUM_QTY</span><br><span class="line">    <span class="keyword">FROM</span> SPJ</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> JNO,PNO</span><br><span class="line">    <span class="keyword">ORDER</span> <span class="keyword">BY</span> JNO,PNO</span><br><span class="line">) A</span><br><span class="line"><span class="keyword">WHERE</span> SUM_QTY <span class="operator">=</span>(</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="built_in">MAX</span>(SUM_QTY) maxsum</span><br><span class="line">    <span class="keyword">FROM</span>(</span><br><span class="line">        <span class="keyword">SELECT</span> JNO,PNO,<span class="built_in">SUM</span>(QTY) SUM_QTY</span><br><span class="line">            <span class="keyword">FROM</span> SPJ</span><br><span class="line">            <span class="keyword">GROUP</span> <span class="keyword">BY</span> JNO,PNO</span><br><span class="line">            <span class="keyword">ORDER</span> <span class="keyword">BY</span> JNO,PNO) B</span><br><span class="line">    <span class="keyword">WHERE</span> A.JNO <span class="operator">=</span> B.JNO</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>实验9 SQL视图</title>
      <link href="/posts/90/"/>
      <url>/posts/90/</url>
      
        <content type="html"><![CDATA[<h1 id="第1关-请为三建工程项目建立一个供应情况的视图v-spq-包括供应商代码-sno-零件代码-pno-供应数量-qty">第1关 请为三建工程项目建立一个供应情况的视图V_SPQ，包括供应商代码(SNO)、零件代码(PNO)、供应数量(QTY)</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> V_SPQ <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> SNO,PNO,QTY</span><br><span class="line"><span class="keyword">FROM</span> SPJ</span><br><span class="line"><span class="keyword">JOIN</span> J <span class="keyword">USING</span>(JNO)</span><br><span class="line"><span class="keyword">WHERE</span> JNAME <span class="operator">=</span> <span class="string">&#x27;三建&#x27;</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> V_SPQ;</span><br></pre></td></tr></table></figure><h1 id="第2关-从视图v-spq找出三建工程项目使用的各种零件代码及其数">第2关 从视图V_SPQ找出三建工程项目使用的各种零件代码及其数</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> PNO ,<span class="built_in">SUM</span>(QTY) SUM_QTY</span><br><span class="line"><span class="keyword">FROM</span> V_SPQ</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> PNO</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> SUM_QTY <span class="keyword">DESC</span></span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第3关-从视图v-spq找出供应商s1的供应情况">第3关 从视图V_SPQ找出供应商S1的供应情况</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> PNO,QTY</span><br><span class="line"><span class="keyword">FROM</span> V_SPQ</span><br><span class="line"><span class="keyword">WHERE</span> SNO <span class="operator">=</span> <span class="string">&#x27;S1&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第4关-定义查询s2供应商的所有供应明细的视图v-spj2">第4关 定义查询S2供应商的所有供应明细的视图V_SPJ2</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> V_SPJ2 <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> SPJ</span><br><span class="line"><span class="keyword">WHERE</span> SNO <span class="operator">=</span> <span class="string">&#x27;S2&#x27;</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> V_SPJ2;</span><br></pre></td></tr></table></figure><h1 id="第5关-定义查询北京的供应商的编号-名称和城市的视图v-bjs">第5关 定义查询北京的供应商的编号、名称和城市的视图V_BJS</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> V_BJS <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> SNO,SNAME,CITY</span><br><span class="line"><span class="keyword">FROM</span> S</span><br><span class="line"><span class="keyword">WHERE</span> CITY <span class="operator">=</span> <span class="string">&#x27;北京&#x27;</span>;</span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> V_BJS;</span><br></pre></td></tr></table></figure><h1 id="第6关-定义查询各工程名称使用的各种颜色零件的个数的视图v-pjq">第6关 定义查询各工程名称使用的各种颜色零件的个数的视图V_PJQ</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> V_PJQ <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> JNAME,COLOR,<span class="built_in">SUM</span>(QTY) SUM_QTY</span><br><span class="line"><span class="keyword">FROM</span> SPJ,P,J</span><br><span class="line"><span class="keyword">WHERE</span> SPJ.PNO <span class="operator">=</span> P.PNO <span class="keyword">AND</span> SPJ.JNO <span class="operator">=</span> J.JNO</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> JNAME,COLOR;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> V_PJQ <span class="keyword">ORDER</span> <span class="keyword">BY</span> V_PJQ.JNAME <span class="keyword">ASC</span>, V_PJQ.COLOR <span class="keyword">ASC</span>;</span><br></pre></td></tr></table></figure><h1 id="第7关-将视图v-spq中供应数量为400的供应商改为-s1-并观察基本表spj的变化">第7关 将视图V_SPQ中供应数量为400的供应商改为’S1’，并观察基本表SPJ的变化</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">UPDATE</span> V_SPQ</span><br><span class="line"><span class="keyword">SET</span> SNO <span class="operator">=</span> <span class="string">&#x27;S1&#x27;</span></span><br><span class="line"><span class="keyword">WHERE</span> QTY<span class="operator">=</span><span class="number">400</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> SPJ;</span><br></pre></td></tr></table></figure><h1 id="第8关-建立比赛-1001-的所有解答的视图v-1001-并要求进行修改和插入操作时仍需保证该视图只有比赛1001的解答">第8关 建立比赛 1001 的所有解答的视图v_1001，并要求进行修改和插入操作时仍需保证该视图只有比赛1001的解答。</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line"></span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> v_1001 <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> solution</span><br><span class="line"><span class="keyword">WHERE</span> contest_id <span class="operator">=</span> <span class="string">&#x27;1001&#x27;</span></span><br><span class="line"><span class="keyword">WITH</span> <span class="keyword">CHECK</span> OPTION;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#保证下面一行MYSQL语句在<span class="number">16</span>行的位置，以保证结果匹配</span><br><span class="line"><span class="keyword">UPDATE</span> v_1001 <span class="keyword">SET</span> v_1001.contest_id <span class="operator">=</span> <span class="number">1002</span>;</span><br></pre></td></tr></table></figure><h1 id="第9关-建立2020级做了1003号题的选手视图v-user2020-1003-包括user-id-name-result">第9关 建立2020级做了1003号题的选手视图v_user2020_1003（包括user_id、name、result）</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line"></span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> v_user2020_1003 <span class="keyword">As</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> u.user_id,name,<span class="keyword">result</span></span><br><span class="line"><span class="keyword">FROM</span> users u,solution s</span><br><span class="line"><span class="keyword">WHERE</span> u.user_id <span class="operator">=</span> s.user_id <span class="keyword">AND</span> s.user_id <span class="keyword">LIKE</span> &quot;2020%&quot; <span class="keyword">AND</span> s.problem_id <span class="operator">=</span> <span class="number">1003</span> ;</span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> v_user2020_1003;</span><br></pre></td></tr></table></figure><h1 id="第10关-建立2020级做了1001号题且result为6的选手视图v-user2020-1001-6">第10关 建立2020级做了1001号题且result为6的选手视图v_user2020_1001_6</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> v_user2020_1001_6 <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> u.user_id,u.name,s.result,s.problem_id</span><br><span class="line"><span class="keyword">FROM</span> users u,solution s</span><br><span class="line"><span class="keyword">WHERE</span> u.user_id <span class="operator">=</span> s.user_id <span class="keyword">AND</span> s.user_id <span class="keyword">LIKE</span> &quot;2020%&quot; <span class="keyword">AND</span> s.problem_id <span class="operator">=</span> <span class="number">1001</span> <span class="keyword">AND</span> s.result <span class="operator">=</span> <span class="number">6</span>;</span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> v_user2020_1001_6;</span><br></pre></td></tr></table></figure><h1 id="第11关-将选手的user-id及解答的平均avgmemory定义为一个视图v-users-avgmemory">第11关 将选手的user_id及解答的平均avgmemory定义为一个视图v_users_avgmemory</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line"></span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> v_users_avgmemory <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> user_id,<span class="built_in">AVG</span>(memory) avgmemory</span><br><span class="line"><span class="keyword">FROM</span> solution</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> user_id;</span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> v_users_avgmemory;</span><br></pre></td></tr></table></figure><h1 id="第12关-删除视图v-1001">第12关 删除视图v_1001</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line"></span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> v_1001;</span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#保证下面一行MYSQL语句在<span class="number">9</span>行的位置，以保证结果匹配</span><br><span class="line"><span class="keyword">SELECT</span> v_1001.<span class="operator">*</span> <span class="keyword">FROM</span> v_1001;</span><br></pre></td></tr></table></figure><h1 id="第13关-在视图v-users-avgmemory中查询平均memory在2000以下的选手信息及平均memory">第13关 在视图v_users_avgmemory中查询平均memory在2000以下的选手信息及平均memory</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line"></span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> v_users_avgmemory</span><br><span class="line"><span class="keyword">WHERE</span> avgmemory <span class="operator">&lt;</span> <span class="number">2000</span></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第14关-在视图v-1001中删除user-id为201902010318的记录">第14关 在视图v_1001中删除user_id为201902010318的记录</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line"></span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> v_1001</span><br><span class="line"><span class="keyword">WHERE</span> user_id <span class="operator">=</span> <span class="number">201902010318</span>;</span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> v_1001;</span><br></pre></td></tr></table></figure><h1 id="第15关-在视图v-users-avgmemory中插入一条记录-2020100904-1800">第15关 在视图v_users_avgmemory中插入一条记录(2020100904，1800)</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line"></span><br><span class="line">#请在第<span class="number">5</span>行开始添加实现代码，务必保证从第<span class="number">5</span>行开始添加代码，以保证结果匹配</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">INSERT INTO</span> v_users_avgmemory <span class="keyword">VALUE</span>(<span class="number">2020100904</span>,<span class="number">1800</span>)</span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第16关-在视图v-user2020-1003中将user-id为20200202的result更改为10">第16关 在视图v_user2020_1003中将user_id为20200202的result更改为10</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">UPDATE</span> v_user2020_1003</span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">result</span> <span class="operator">=</span> <span class="number">10</span></span><br><span class="line"><span class="keyword">WHERE</span> user_id <span class="operator">=</span> <span class="string">&#x27;20200202&#x27;</span>;</span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SELECT</span> v_user2020_1003.<span class="operator">*</span> <span class="keyword">FROM</span> v_user2020_1003 <span class="keyword">WHERE</span> v_user2020_1003.user_id <span class="operator">=</span> <span class="string">&#x27;20200202&#x27;</span>;</span><br></pre></td></tr></table></figure><h1 id="第17关-根据该需求给spj表插入相应数据">第17关 根据该需求给SPJ表插入相应数据</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">INSERT INTO</span> SPJ (SNO,PNO,JNO,QTY)</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    <span class="string">&#x27;S3&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;P4&#x27;</span>,</span><br><span class="line">    JNO,</span><br><span class="line">    <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">FROM</span> J</span><br><span class="line"><span class="keyword">WHERE</span> JNAME <span class="keyword">LIKE</span> <span class="string">&#x27;%厂&#x27;</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> SPJ;</span><br></pre></td></tr></table></figure><h1 id="第18关-创建一个名为v-pjmaxsp的视图">第18关 创建一个名为V_PJMAXSP的视图</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> TemTable <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> JNO,SNO,<span class="built_in">SUM</span>(QTY) SUM_QTY</span><br><span class="line"><span class="keyword">FROM</span> SPJ</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> SNO,JNO</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> JNO,QTY <span class="keyword">DESC</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> V_PJMAXSP <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> TemTable.JNO,TemTable.SNO,SNAME</span><br><span class="line"><span class="keyword">FROM</span> TemTable,S</span><br><span class="line"><span class="keyword">WHERE</span> SUM_QTY<span class="operator">&gt;=</span><span class="keyword">ALL</span>(<span class="keyword">SELECT</span> SUM_QTY <span class="keyword">FROM</span> TemTable t <span class="keyword">WHERE</span> TemTable.JNO<span class="operator">=</span>t.JNO)</span><br><span class="line">    <span class="keyword">AND</span> TemTable.SNO <span class="operator">=</span> S.SNO</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> JNO,SNO;</span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> V_PJMAXSP;</span><br></pre></td></tr></table></figure><h1 id="第19关-创建一个名为test的视图">第19关 创建一个名为test的视图</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line"></span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> test <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> u.<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> users u</span><br><span class="line"><span class="keyword">JOIN</span> solution s <span class="keyword">USING</span>(user_id)</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>(</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">    <span class="keyword">FROM</span> solution A</span><br><span class="line">    <span class="keyword">WHERE</span> A.user_id <span class="operator">=</span> <span class="string">&#x27;202002020217&#x27;</span> <span class="keyword">AND</span> <span class="keyword">result</span> <span class="operator">=</span> <span class="number">4</span> <span class="keyword">AND</span> <span class="keyword">language</span> <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">AND</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>(</span><br><span class="line">            <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">            <span class="keyword">FROM</span> solution B</span><br><span class="line">            <span class="keyword">WHERE</span> u.user_id <span class="operator">=</span> B.user_id <span class="keyword">AND</span> A.problem_id <span class="operator">=</span> B.problem_id</span><br><span class="line">        )</span><br><span class="line">)</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> u.user_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> s.contest_id) <span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> test;</span><br></pre></td></tr></table></figure><h1 id="第20关-创建一个名为v-qty-rank的视图">第20关 创建一个名为V_QTY_RANK的视图</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> V_QTY_RANK</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">*</span>,</span><br><span class="line">    <span class="keyword">CASE</span></span><br><span class="line">        <span class="keyword">WHEN</span> QTY <span class="operator">&gt;=</span> <span class="number">500</span> <span class="keyword">THEN</span> <span class="string">&#x27;A&#x27;</span></span><br><span class="line">        <span class="keyword">WHEN</span> QTY <span class="keyword">BETWEEN</span> <span class="number">200</span> <span class="keyword">AND</span> <span class="number">500</span> <span class="keyword">THEN</span> <span class="string">&#x27;B&#x27;</span></span><br><span class="line">        <span class="keyword">WHEN</span> QTY <span class="operator">&lt;</span> <span class="number">200</span> <span class="keyword">THEN</span> <span class="string">&#x27;C&#x27;</span></span><br><span class="line">        <span class="keyword">ELSE</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">END</span> <span class="keyword">AS</span> QTY_RANK</span><br><span class="line"><span class="keyword">FROM</span> SPJ</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> QTY_RANK;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> V_QTY_RANK;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>实验8 SQL的复杂多表查询-2</title>
      <link href="/posts/14962/"/>
      <url>/posts/14962/</url>
      
        <content type="html"><![CDATA[<h1 id="第1关-基于派生表查询每个队员解答中超过他平均memory的user-id及题目编号problem-id">第1关 基于派生表查询每个队员解答中超过他平均memory的user_id及题目编号problem_id</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> s.user_id,s.problem_id</span><br><span class="line"><span class="keyword">FROM</span>(</span><br><span class="line">    <span class="keyword">SELECT</span> user_id,<span class="built_in">AVG</span>(memory) <span class="keyword">AS</span> AM</span><br><span class="line">    <span class="keyword">FROM</span> solution</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> user_id</span><br><span class="line">) <span class="keyword">AS</span> Ta</span><br><span class="line"><span class="keyword">JOIN</span> solution s <span class="keyword">USING</span>(user_id)</span><br><span class="line"><span class="keyword">WHERE</span> s.memory <span class="operator">&gt;</span> Ta.AM</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第2关-用any-all实现查询2019级选手-user-id前4位为2019-满足比2020级其中一个选手注册时间早即可的选手">第2关 用ANY/ALL实现查询2019级选手（user_id前4位为2019）满足比2020级其中一个选手注册时间早即可的选手</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> user_id,reg_time,name</span><br><span class="line"><span class="keyword">FROM</span> users</span><br><span class="line"><span class="keyword">WHERE</span> user_id <span class="keyword">LIKE</span> <span class="string">&#x27;2019%&#x27;</span> <span class="keyword">AND</span> reg_time <span class="operator">&lt;</span> <span class="keyword">ANY</span>(</span><br><span class="line">    <span class="keyword">SELECT</span> reg_time</span><br><span class="line">    <span class="keyword">FROM</span> users</span><br><span class="line">    <span class="keyword">WHERE</span> user_id <span class="keyword">LIKE</span> <span class="string">&#x27;2020%&#x27;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第3关-用聚集查询实现查询2019级选手-user-id前4位为2019-满足比2020级其中一个选手注册时间早即可的选手">第3关 用聚集查询实现查询2019级选手（user_id前4位为2019）满足比2020级其中一个选手注册时间早即可的选手</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> user_id,reg_time,name</span><br><span class="line"><span class="keyword">FROM</span> users</span><br><span class="line"><span class="keyword">WHERE</span> user_id <span class="keyword">LIKE</span> &quot;2019%&quot; <span class="keyword">AND</span> reg_time <span class="operator">&lt;</span>(</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="built_in">MAX</span>(reg_time)</span><br><span class="line">    <span class="keyword">FROM</span> users</span><br><span class="line">    <span class="keyword">WHERE</span> user_id <span class="keyword">LIKE</span> &quot;2020%&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第4关-用any-all实现查询2019级选手所有比2020级选手注册时间都早的选手信息">第4关 用ANY/ALL实现查询2019级选手所有比2020级选手注册时间都早的选手信息</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> users</span><br><span class="line"><span class="keyword">WHERE</span> user_id <span class="keyword">LIKE</span> &quot;2019%&quot; <span class="keyword">AND</span> reg_time <span class="operator">&lt;</span> <span class="keyword">ALL</span>(</span><br><span class="line">    <span class="keyword">SELECT</span> reg_time</span><br><span class="line">    <span class="keyword">FROM</span> users</span><br><span class="line">    <span class="keyword">WHERE</span> user_id <span class="keyword">LIKE</span>&quot;2020%&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第5关-用聚集查询实现查询2019级选手所有比2020级选手注册时间都早的选手信息">第5关 用聚集查询实现查询2019级选手所有比2020级选手注册时间都早的选手信息</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> users</span><br><span class="line"><span class="keyword">WHERE</span> user_id <span class="keyword">LIKE</span> &quot;2019%&quot; <span class="keyword">AND</span> reg_time<span class="operator">&lt;</span>(</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="built_in">MIN</span>(reg_time)</span><br><span class="line">    <span class="keyword">FROM</span> users</span><br><span class="line">    <span class="keyword">WHERE</span> user_id <span class="keyword">LIKE</span> &quot;2020%&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第6关-用-not-exists-实现查询至少参与过-202002020217-选手参与过的所有比赛的选手信息">第6关 用 NOT EXISTS 实现查询至少参与过&quot;202002020217&quot;选手参与过的所有比赛的选手信息</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> users</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>(</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">    <span class="keyword">FROM</span> (</span><br><span class="line">        <span class="keyword">SELECT</span> contest_id</span><br><span class="line">        <span class="keyword">FROM</span> solution s</span><br><span class="line">        <span class="keyword">WHERE</span> user_id <span class="operator">=</span> <span class="string">&#x27;202002020217&#x27;</span> <span class="keyword">AND</span> contest_id <span class="keyword">IS</span> <span class="keyword">NOT NULL</span></span><br><span class="line">    ) s1</span><br><span class="line">    <span class="keyword">WHERE</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> (</span><br><span class="line">        <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">        <span class="keyword">FROM</span> solution s2</span><br><span class="line">        <span class="keyword">WHERE</span> s1.contest_id <span class="operator">=</span> s2.contest_id <span class="keyword">AND</span> users.user_id <span class="operator">=</span> s2.user_id</span><br><span class="line">    )</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第7关-求至少用了供应商-s1所供应的全部零件的工程号-jno">第7关 求至少用了供应商 S1所供应的全部零件的工程号 JNO</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> a.JNO</span><br><span class="line"><span class="keyword">FROM</span>(</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">    <span class="keyword">FROM</span> SPJ</span><br><span class="line">    <span class="keyword">WHERE</span> PNO <span class="keyword">IN</span> (</span><br><span class="line">        <span class="keyword">SELECT</span> PNO</span><br><span class="line">        <span class="keyword">FROM</span> (</span><br><span class="line">            <span class="keyword">SELECT</span> PNO,JNO</span><br><span class="line">            <span class="keyword">FROM</span> SPJ</span><br><span class="line">            <span class="keyword">WHERE</span> SNO <span class="operator">=</span> <span class="string">&#x27;S1&#x27;</span></span><br><span class="line">        ) Ta</span><br><span class="line">    )</span><br><span class="line">) a,</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">    <span class="keyword">FROM</span> SPJ</span><br><span class="line">    <span class="keyword">WHERE</span> PNO <span class="keyword">IN</span> (</span><br><span class="line">        <span class="keyword">SELECT</span> PNO</span><br><span class="line">        <span class="keyword">FROM</span> (</span><br><span class="line">            <span class="keyword">SELECT</span> PNO,JNO</span><br><span class="line">            <span class="keyword">FROM</span> SPJ</span><br><span class="line">            <span class="keyword">WHERE</span> SNO <span class="operator">=</span> <span class="string">&#x27;S1&#x27;</span></span><br><span class="line">        ) Ta</span><br><span class="line">    )</span><br><span class="line">) b</span><br><span class="line"><span class="keyword">WHERE</span> a.JNO <span class="operator">=</span> b.JNO <span class="keyword">AND</span> a.PNO <span class="operator">!=</span> b.PN</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>实验7 SQL的复杂多表查询-1</title>
      <link href="/posts/15145/"/>
      <url>/posts/15145/</url>
      
        <content type="html"><![CDATA[<h1 id="第1关-求各颜色零件的平均重量">第1关 求各颜色零件的平均重量</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    COLOR,</span><br><span class="line">    <span class="built_in">AVG</span>(WEIGHT)</span><br><span class="line"><span class="keyword">FROM</span> P</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> COLOR;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第2关-求北京和天津供应商的总个数">第2关 求北京和天津供应商的总个数</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line"></span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    CITY,</span><br><span class="line">    <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line"><span class="keyword">FROM</span> S</span><br><span class="line"><span class="keyword">WHERE</span> CITY <span class="operator">=</span> <span class="string">&#x27;北京&#x27;</span></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    CITY,</span><br><span class="line">    <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line"><span class="keyword">FROM</span> S</span><br><span class="line"><span class="keyword">WHERE</span> CITY <span class="operator">=</span> <span class="string">&#x27;天津&#x27;</span></span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第3关-求各供应商供应的零件总数">第3关 求各供应商供应的零件总数</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line"></span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    SNO,</span><br><span class="line">    <span class="built_in">SUM</span>(QTY) SUM_QTY</span><br><span class="line"><span class="keyword">FROM</span> SPJ</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> SNO</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> SUM_QTY <span class="keyword">DESC</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第4关-求各供应商供应给各工程的零件总数">第4关 求各供应商供应给各工程的零件总数</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line"></span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    SNO,</span><br><span class="line">    JNO,</span><br><span class="line">    <span class="built_in">SUM</span>(QTY) SUM_QTY</span><br><span class="line"><span class="keyword">FROM</span> SPJ</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> SNO,JNO</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> SNO <span class="keyword">DESC</span>, JNO <span class="keyword">DESC</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第5关-求重量大于所有零件平均重量的零件名称">第5关 求重量大于所有零件平均重量的零件名称</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    PNAME</span><br><span class="line"><span class="keyword">FROM</span> P</span><br><span class="line"><span class="keyword">WHERE</span> WEIGHT <span class="operator">&gt;</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="built_in">AVG</span>(WEIGHT)</span><br><span class="line">    <span class="keyword">FROM</span> P</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第6关-查询供应了1000个以上零件的供应商名称">第6关 查询供应了1000个以上零件的供应商名称</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    SNAME</span><br><span class="line"><span class="keyword">FROM</span> S,SPJ</span><br><span class="line"><span class="keyword">WHERE</span> S.SNO <span class="operator">=</span> SPJ.SNO</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> SNAME</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">SUM</span>(QTY)<span class="operator">&gt;</span><span class="number">1000</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> SNAME <span class="keyword">DESC</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第7关-统计p表中颜色为蓝色的零件个数-并指定该查询列的名称为-蓝色零件数">第7关 统计P表中颜色为蓝色的零件个数，并指定该查询列的名称为“蓝色零件数”</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    <span class="built_in">COUNT</span>(COLOR) <span class="string">&#x27;蓝色零件数&#x27;</span></span><br><span class="line"><span class="keyword">FROM</span> P</span><br><span class="line"><span class="keyword">WHERE</span> COLOR <span class="operator">=</span> <span class="string">&#x27;蓝&#x27;</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第8关-查询p表中各零件的编号-名称及重量按85-计算后的信息-其中重量按85-计算后的查询列名改为-零件净重">第8关 查询P表中各零件的编号，名称及重量按85%计算后的信息，其中重量按85%计算后的查询列名改为“零件净重”</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    PNO,</span><br><span class="line">    PNAME,</span><br><span class="line">    WEIGHT <span class="operator">*</span> <span class="number">0.85</span> <span class="string">&#x27;零件净重&#x27;</span></span><br><span class="line"><span class="keyword">FROM</span> P</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第9关-查询-s表status值大于20且小于50-或sname字段值的第一个字为-精-或第三个字为-益-或-民-的供应">第9关 查询 S表STATUS值大于20且小于50，或SNAME字段值的第一个字为“精”或第三个字为“益”或“民”的供应</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> S</span><br><span class="line"><span class="keyword">WHERE</span> (STATUS <span class="operator">&gt;</span> <span class="number">20</span> <span class="keyword">AND</span> STATUS <span class="operator">&lt;</span> <span class="number">50</span>)<span class="keyword">OR</span> (SNAME <span class="keyword">LIKE</span> <span class="string">&#x27;精%&#x27;</span> <span class="keyword">OR</span> SNAME <span class="keyword">LIKE</span> <span class="string">&#x27;__益&#x27;</span> <span class="keyword">OR</span> SNAME <span class="keyword">LIKE</span> <span class="string">&#x27;__民&#x27;</span>);</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第10关-将spj表按qty值降序排列-再找出spj表中前6条记录-用limit-6">第10关 将SPJ表按QTY值降序排列，再找出SPJ表中前6条记录(用limit 6)</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line">SELEC <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> SPJ</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> QTY <span class="keyword">DESC</span></span><br><span class="line">LIMIT <span class="number">6</span></span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第11关-找出供应零件总数量不低于1000的供应商号码-及每个供应商供应的总数量-并且结果按总数量降序排列">第11关 找出供应零件总数量不低于1000的供应商号码，及每个供应商供应的总数量，并且结果按总数量降序排列</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    SNO,</span><br><span class="line">    <span class="built_in">SUM</span>(QTY) SUM_QTY</span><br><span class="line"><span class="keyword">FROM</span> SPJ</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> SNO</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">SUM</span>(QTY) <span class="operator">&gt;=</span><span class="number">1000</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> SUM_QTY <span class="keyword">DESC</span></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第12关-找出工程项目j1使用的各种零件的名称及其数量">第12关 找出工程项目J1使用的各种零件的名称及其数量</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    PNAME,</span><br><span class="line">    <span class="built_in">SUM</span>(QTY) SUM_QTY</span><br><span class="line"><span class="keyword">FROM</span> SPJ,P</span><br><span class="line"><span class="keyword">WHERE</span> SPJ.PNO <span class="operator">=</span> P.PNO <span class="keyword">AND</span> SPJ.JNO <span class="operator">=</span> <span class="string">&#x27;J1&#x27;</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> PNAME</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> SUM_QTY <span class="keyword">DESC</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第13关-求使用了300个及以上p1零件的工程名称">第13关 求使用了300个及以上P1零件的工程名称</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    JNAME</span><br><span class="line"><span class="keyword">FROM</span> J</span><br><span class="line"><span class="keyword">JOIN</span> SPJ <span class="keyword">USING</span>(JNO)</span><br><span class="line"><span class="keyword">WHERE</span> SPJ.PNO <span class="operator">=</span> <span class="string">&#x27;P1&#x27;</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> JNAME</span><br><span class="line"><span class="keyword">HAVING</span>  <span class="built_in">SUM</span>(QTY) <span class="operator">&gt;</span> <span class="number">300</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第14关-求各工程-名-使用的各城市供应的零件总数">第14关 求各工程（名）使用的各城市供应的零件总数</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    JNAME,</span><br><span class="line">    S.CITY,</span><br><span class="line">    <span class="built_in">SUM</span>(QTY) SUM_QTY</span><br><span class="line"><span class="keyword">FROM</span> SPJ</span><br><span class="line"><span class="keyword">JOIN</span> S <span class="keyword">USING</span>(SNO)</span><br><span class="line"><span class="keyword">JOIN</span> J <span class="keyword">USING</span>(JNO)</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> JNAME,S.CITY</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> JNAME <span class="keyword">DESC</span>,S.CITY <span class="keyword">DESC</span></span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第15关-用嵌套查询这样的工程：供给该工程的零件p3的平均供应量-大于其中一种供给工程j1的零件的最大供应量">第15关 用嵌套查询这样的工程：供给该工程的零件P3的平均供应量，大于其中一种供给工程J1的零件的最大供应量</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> JNO</span><br><span class="line"><span class="keyword">FROM</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> JNO,<span class="built_in">AVG</span>(QTY) JQ</span><br><span class="line">    <span class="keyword">FROM</span> SPJ</span><br><span class="line">    <span class="keyword">WHERE</span> PNO <span class="operator">=</span> <span class="string">&#x27;P3&#x27;</span></span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> JNO</span><br><span class="line">) T1</span><br><span class="line"><span class="keyword">WHERE</span> JQ <span class="operator">&gt;</span><span class="keyword">ANY</span>(</span><br><span class="line">    <span class="keyword">SELECT</span> PQ</span><br><span class="line">    <span class="keyword">FROM</span>(</span><br><span class="line">        <span class="keyword">SELECT</span> <span class="built_in">MAX</span>(QTY) PQ</span><br><span class="line">        <span class="keyword">FROM</span> SPJ</span><br><span class="line">        <span class="keyword">WHERE</span> JNO <span class="operator">=</span><span class="string">&#x27;J1&#x27;</span></span><br><span class="line">        <span class="keyword">GROUP</span> <span class="keyword">BY</span> PNO</span><br><span class="line">    ) T2</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第16关-用链接查询这样的工程：供给该工程的零件p3的平均供应量-大于其中一种供给工程j1的零件的最大供应量">第16关 用链接查询这样的工程：供给该工程的零件P3的平均供应量，大于其中一种供给工程J1的零件的最大供应量</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> JNO</span><br><span class="line"><span class="keyword">FROM</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> JNO,<span class="built_in">AVG</span>(QTY) JQ</span><br><span class="line">    <span class="keyword">FROM</span> SPJ</span><br><span class="line">    <span class="keyword">WHERE</span> PNO <span class="operator">=</span> <span class="string">&#x27;P3&#x27;</span></span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> JNO</span><br><span class="line">) T1</span><br><span class="line"><span class="keyword">JOIN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="built_in">MAX</span>(QTY) PQ</span><br><span class="line">    <span class="keyword">FROM</span> SPJ</span><br><span class="line">    <span class="keyword">WHERE</span> JNO <span class="operator">=</span><span class="string">&#x27;J1&#x27;</span></span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> PNO</span><br><span class="line">) T2</span><br><span class="line"><span class="keyword">ON</span> T1.JQ <span class="operator">&gt;</span> T2.PQ</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第17关-查询这样的工程号：供应该工程零件p3的平均供应量-不小于工程j1使用各零件合计数量的最小值">第17关 查询这样的工程号：供应该工程零件P3的平均供应量，不小于工程J1使用各零件合计数量的最小值</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> JNO</span><br><span class="line"><span class="keyword">FROM</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> JNO,<span class="built_in">AVG</span>(QTY) JQ</span><br><span class="line">    <span class="keyword">FROM</span> SPJ</span><br><span class="line">    <span class="keyword">WHERE</span> PNO<span class="operator">=</span><span class="string">&#x27;P3&#x27;</span></span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> JN</span><br><span class="line">) T1</span><br><span class="line"><span class="keyword">WHERE</span> JQ<span class="operator">&gt;=</span>(</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="built_in">MIN</span>(PQ)</span><br><span class="line">    <span class="keyword">FROM</span> (</span><br><span class="line">        <span class="keyword">SELECT</span> <span class="built_in">SUM</span>(QTY) PQ</span><br><span class="line">        <span class="keyword">FROM</span> SPJ</span><br><span class="line">        <span class="keyword">WHERE</span> JNO <span class="operator">=</span> <span class="string">&#x27;J1&#x27;</span></span><br><span class="line">        <span class="keyword">GROUP</span> <span class="keyword">BY</span> PNO</span><br><span class="line">    ) T2</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>实验6 SQL的多表查询-2</title>
      <link href="/posts/48365/"/>
      <url>/posts/48365/</url>
      
        <content type="html"><![CDATA[<h1 id="第1关-查询每个选手的信息及其提交的解答信息-没做题的选手不显示">第1关 查询每个选手的信息及其提交的解答信息，没做题的选手不显示</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码，在语句末尾加LIMIT <span class="number">50</span>，即可显示查询结果前<span class="number">50</span>条。</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> users u,solution s</span><br><span class="line"><span class="keyword">WHERE</span> u.user_id <span class="operator">=</span> s.user_id</span><br><span class="line">LIMIT <span class="number">50</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第2关-查询做了1001题且耗时大于500-time-的选手信息">第2关 查询做了1001题且耗时大于500（time）的选手信息</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> u.user_id,u.reg_time,u.name</span><br><span class="line"><span class="keyword">FROM</span> users u,solution s</span><br><span class="line"><span class="keyword">WHERE</span> u.user_id <span class="operator">=</span> s.user_id <span class="keyword">AND</span> s.time<span class="operator">&gt;</span><span class="number">500</span> <span class="keyword">AND</span> s.problem_id <span class="operator">=</span> <span class="number">1001</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第3关-查询所有选手信息及其提交的解答信息-没做题的选手也要显示">第3关 查询所有选手信息及其提交的解答信息，没做题的选手也要显示</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码，在语句末尾加LIMIT <span class="number">50</span>，即可显示查询结果前<span class="number">50</span>条。</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> users u</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> solution s</span><br><span class="line">    <span class="keyword">ON</span> u.user_id <span class="operator">=</span> s.user_id</span><br><span class="line">LIMIT <span class="number">50</span>;</span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第4关-查询每个选手的信息-交的题目-和提交的结果-没做题的选手不显示">第4关 查询每个选手的信息、交的题目、和提交的结果，没做题的选手不显示</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码，在语句末尾加LIMIT <span class="number">50</span>，即可显示查询结果前<span class="number">50</span>条。</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> u.user_id,u.reg_time,u.name,s.problem_id,s.result</span><br><span class="line"><span class="keyword">FROM</span> users u</span><br><span class="line"><span class="keyword">JOIN</span> solution s</span><br><span class="line">    <span class="keyword">ON</span> u.user_id <span class="operator">=</span> s.user_id</span><br><span class="line">LIMIT <span class="number">50</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第5关-用嵌套查询查找和problem-id为-1026-的题目属于同一个比赛的题目信息">第5关 用嵌套查询查找和problem_id为 1026 的题目属于同一个比赛的题目信息</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> problem p</span><br><span class="line"><span class="keyword">WHERE</span> problem_id <span class="keyword">IN</span>(</span><br><span class="line">    <span class="keyword">SELECT</span> problem_id</span><br><span class="line">    <span class="keyword">FROM</span> contest_problem</span><br><span class="line">    <span class="keyword">WHERE</span> contest_id <span class="keyword">IN</span>(</span><br><span class="line">        <span class="keyword">SELECT</span> contest_id</span><br><span class="line">        <span class="keyword">FROM</span> contest_problem</span><br><span class="line">        <span class="keyword">WHERE</span> problem_id <span class="operator">=</span> <span class="string">&#x27;1026&#x27;</span></span><br><span class="line">    )</span><br><span class="line">)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> problem_id;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第6关-用连接查询查找和problem-id为-1026-的题目属于同一个比赛的题目信息">第6关 用连接查询查找和problem_id为 1026 的题目属于同一个比赛的题目信息</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> p.problem_id,title,description,hint,time_limit,memory_limit</span><br><span class="line"><span class="keyword">FROM</span> problem p,contest_problem cpA,contest_problem cpB</span><br><span class="line"><span class="keyword">WHERE</span> cpA.problem_id <span class="operator">=</span> <span class="number">1026</span> <span class="keyword">AND</span> cpA.contest_id <span class="operator">=</span> cpB.contest_id <span class="keyword">AND</span> cpB.problem_id <span class="operator">=</span> p.problem_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> p.problem_id</span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第7关-用-exists-实现查询做了-1032-号题的选手信息">第7关 用 EXISTS 实现查询做了 1032 号题的选手信息</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> users u</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">EXISTS</span>(</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">    <span class="keyword">FROM</span> solution</span><br><span class="line">    <span class="keyword">WHERE</span> problem_id <span class="operator">=</span> <span class="number">1032</span> <span class="keyword">AND</span> u.user_id <span class="operator">=</span> user_id</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第8关-用not-exists实现查询没做-1032-号题的选手信息">第8关 用NOT EXISTS实现查询没做 1032 号题的选手信息</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> users u</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>(</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">    <span class="keyword">FROM</span> solution s</span><br><span class="line">    <span class="keyword">WHERE</span> problem_id <span class="operator">=</span> <span class="number">1032</span> <span class="keyword">AND</span> u.user_id <span class="operator">=</span> s.user_id</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第9关-用-exists-实现查询和problem-id为-1026-的题目属于同一个比赛的题目信息">第9关 用 EXISTS 实现查询和problem_id为 1026 的题目属于同一个比赛的题目信息</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> problem p</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">EXISTS</span>(</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">    <span class="keyword">FROM</span> contest_problem cpA,contest_problem cpB</span><br><span class="line">    <span class="keyword">WHERE</span> cpA.problem_id <span class="operator">=</span> <span class="number">1026</span> <span class="keyword">AND</span> cpA.contest_id <span class="operator">=</span> cpB.contest_id <span class="keyword">AND</span> p.problem_id <span class="operator">=</span> cpB.problem_id</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第10关-用-not-exists-实现查询参与过所有比赛的选手信息">第10关 用 NOT EXISTS 实现查询参与过所有比赛的选手信息</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> users u</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>(</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">    <span class="keyword">FROM</span> contest c</span><br><span class="line">    <span class="keyword">WHERE</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>(</span><br><span class="line">        <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">        <span class="keyword">FROM</span> solution s</span><br><span class="line">        <span class="keyword">WHERE</span> u.user_id <span class="operator">=</span> s.user_id <span class="keyword">AND</span> c.contest_id <span class="operator">=</span> s.contest_id</span><br><span class="line">    )</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>实验5 SQL的多表查询-1</title>
      <link href="/posts/43230/"/>
      <url>/posts/43230/</url>
      
        <content type="html"><![CDATA[<h1 id="第1关-等值连接：求s表和j表城市相同的等值连接-列顺序还是按照s-j表">第1关 等值连接：求S表和J表城市相同的等值连接(列顺序还是按照S、J表)</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> S,J</span><br><span class="line"><span class="keyword">WHERE</span> S.CITY <span class="operator">=</span> J.CITY</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第2关-查询供应情况-并显示供应商-零件和工程三者的名称">第2关 查询供应情况，并显示供应商、零件和工程三者的名称</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> SNAME,PNAME,JNAME,QTY</span><br><span class="line"><span class="keyword">FROM</span> SPJ</span><br><span class="line"><span class="keyword">JOIN</span> S <span class="keyword">USING</span> (SNO)</span><br><span class="line"><span class="keyword">JOIN</span> P <span class="keyword">USING</span>(PNO)</span><br><span class="line"><span class="keyword">JOIN</span> J <span class="keyword">USING</span>(JNO)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 第二种写法</span></span><br><span class="line"><span class="keyword">SELECT</span> SNAME,PNAME,JNAME,QTY</span><br><span class="line"><span class="keyword">FROM</span> SPJ</span><br><span class="line"><span class="keyword">JOIN</span> S <span class="keyword">ON</span> SPJ.SNO <span class="operator">=</span> S.SNO</span><br><span class="line"><span class="keyword">JOIN</span> P <span class="keyword">ON</span> SPJ.PNO <span class="operator">=</span> P.PNO</span><br><span class="line"><span class="keyword">JOIN</span> J <span class="keyword">ON</span> SPJ.JNO <span class="operator">=</span> J.JNO</span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第3关-找出上海厂商供应的所有零件号码">第3关 找出上海厂商供应的所有零件号码</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> PNO</span><br><span class="line"><span class="keyword">FROM</span> SPJ,S</span><br><span class="line"><span class="keyword">WHERE</span> SPJ.SNO <span class="operator">=</span> S.SNO <span class="keyword">AND</span> S.CITY <span class="operator">=</span> <span class="string">&#x27;上海&#x27;</span></span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第4关-找出使用上海产的零件的工程名称">第4关 找出使用上海产的零件的工程名称</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> JNAME</span><br><span class="line"><span class="keyword">FROM</span> J</span><br><span class="line"><span class="keyword">WHERE</span> JNO <span class="keyword">IN</span>(</span><br><span class="line">    <span class="keyword">SELECT</span> JNO</span><br><span class="line">    <span class="keyword">FROM</span> SPJ,S</span><br><span class="line">    <span class="keyword">WHERE</span> SPJ.SNO <span class="operator">=</span> S.SNO <span class="keyword">AND</span> S.CITY <span class="operator">=</span> <span class="string">&#x27;上海&#x27;</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> JNAME <span class="keyword">DESC</span></span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第5关-找出没有使用天津产的零件的工程号码">第5关  找出没有使用天津产的零件的工程号码</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> JNO</span><br><span class="line"><span class="keyword">FROM</span> J</span><br><span class="line"><span class="keyword">WHERE</span> JNO <span class="keyword">NOT</span> <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> JNO</span><br><span class="line">    <span class="keyword">FROM</span> SPJ,S</span><br><span class="line">    <span class="keyword">WHERE</span> SPJ.SNO <span class="operator">=</span> S.SNO <span class="keyword">AND</span> S.CITY <span class="operator">=</span> <span class="string">&#x27;天津&#x27;</span></span><br><span class="line">);</span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第6关-求供应工程j1零件为红色的供应商号码sno">第6关 求供应工程J1零件为红色的供应商号码SNO</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> SNO</span><br><span class="line"><span class="keyword">FROM</span> SPJ,P</span><br><span class="line"><span class="keyword">WHERE</span> SPJ.JNO <span class="operator">=</span> <span class="string">&#x27;J1&#x27;</span> <span class="keyword">AND</span> SPJ.PNO <span class="operator">=</span> P.PNO <span class="keyword">AND</span> P.COLOR <span class="operator">=</span> <span class="string">&#x27;红&#x27;</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第7关-求没有使用天津供应商生产的红色零件的工程号-jno">第7关 求没有使用天津供应商生产的红色零件的工程号 JNO</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> JNO</span><br><span class="line"><span class="keyword">FROM</span> J</span><br><span class="line"><span class="keyword">WHERE</span> JNO <span class="keyword">NOT</span> <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> JNO</span><br><span class="line">    <span class="keyword">FROM</span> SPJ,S,P</span><br><span class="line">    <span class="keyword">WHERE</span>  SPJ.SNO <span class="operator">=</span> S.SNO <span class="keyword">AND</span> SPJ.PNO <span class="operator">=</span> P.PNO <span class="keyword">AND</span></span><br><span class="line">        P.COLOR <span class="operator">=</span> <span class="string">&#x27;红&#x27;</span> <span class="keyword">AND</span> S.CITY <span class="operator">=</span> <span class="string">&#x27;天津&#x27;</span></span><br><span class="line">)</span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第8关-查询所有-红色-的15公斤及以上的零件名">第8关 查询所有“红色”的15公斤及以上的零件名</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> PNAME</span><br><span class="line"><span class="keyword">FROM</span> P</span><br><span class="line"><span class="keyword">WHERE</span> COLOR <span class="operator">=</span> <span class="string">&#x27;红&#x27;</span> <span class="keyword">AND</span> WEIGHT <span class="operator">&gt;=</span> <span class="number">15</span>;</span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第9关-查询工程名称中含有-厂-字的工程明细">第9关 查询工程名称中含有“厂”字的工程明细</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> J</span><br><span class="line"><span class="keyword">WHERE</span> JNAME <span class="keyword">LIKE</span> <span class="string">&#x27;%厂&#x27;</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>实验4 MySQL单表查询</title>
      <link href="/posts/43911/"/>
      <url>/posts/43911/</url>
      
        <content type="html"><![CDATA[<h1 id="第1关-在users表中新增一个用户-user-id为2019100904学号-name为-2019-物联网-李明">第1关 在users表中新增一个用户，user_id为2019100904学号，name为’2019-物联网-李明’</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">INSERT INTO</span> users(user_id,name)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">2019100904</span>,<span class="string">&#x27;2019-物联网-李明&#x27;</span>);</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> users.user_id <span class="operator">=</span> <span class="string">&#x27;2019100904&#x27;</span>;</span><br></pre></td></tr></table></figure><h1 id="第2关-在users表中更新用户-user-id为robot-2-的信息-name设为-机器人二号">第2关 在users表中更新用户 user_id为robot_2 的信息，name设为 ‘机器人二号’</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">UPDATE</span> users</span><br><span class="line"><span class="keyword">SET</span> name<span class="operator">=</span><span class="string">&#x27;机器人二号&#x27;</span></span><br><span class="line"><span class="keyword">WHERE</span> user_id<span class="operator">=</span><span class="string">&#x27;robot_2&#x27;</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> users.user_id <span class="operator">=</span> <span class="string">&#x27;robot_2&#x27;</span>;</span><br></pre></td></tr></table></figure><h1 id="第3关-将solution表中所有-problem-id-为1003-题目的解答结果-result-设为-6">第3关 将solution表中所有 problem_id 为1003 题目的解答结果（result）设为 6</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">UPDATE</span> solution</span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">result</span><span class="operator">=</span><span class="number">6</span></span><br><span class="line"><span class="keyword">WHERE</span> problem_id<span class="operator">=</span><span class="number">1003</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> solution <span class="keyword">WHERE</span> solution.problem_id <span class="operator">=</span> <span class="number">1003</span>;</span><br></pre></td></tr></table></figure><h1 id="第4关-删除solution表中比赛contest-id-为1001的全部解答">第4关 删除solution表中比赛contest_id 为1001的全部解答</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> solution</span><br><span class="line"><span class="keyword">WHERE</span> contest_id<span class="operator">=</span><span class="number">1001</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> solution <span class="keyword">WHERE</span> solution.contest_id <span class="operator">=</span> <span class="number">1001</span>;</span><br></pre></td></tr></table></figure><h1 id="第5关-查询所有-contest-的-title-和-end-time">第5关 查询所有 contest 的 title 和 end_time</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> title,end_time</span><br><span class="line"><span class="keyword">FROM</span> contest;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第6关-查询哪些选手的-user-id-提交过-solution-要求结果中-user-id-不重复">第6关 查询哪些选手的 user_id 提交过 solution，要求结果中 user_id 不重复</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> user_id</span><br><span class="line"><span class="keyword">FROM</span> solution;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第7关-查询-end-time-晚于-2020-11-21-17-30-00-的-contest-id">第7关 查询 end_time 晚于 ‘2020-11-21 17:30:00’ 的 contest_id</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> contest_id <span class="keyword">FROM</span> contest</span><br><span class="line"><span class="keyword">WHERE</span> end_time<span class="operator">&gt;</span><span class="string">&#x27;2020-11-21 17:30:00&#x27;</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第8关-查询-problem-id-在-1005-1009-之间的-problem-的-title">第8关 查询 problem_id 在 1005~1009 之间的 problem 的 title</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> title <span class="keyword">FROM</span> problem</span><br><span class="line"><span class="keyword">WHERE</span> problem_id<span class="operator">&gt;=</span><span class="number">1005</span> <span class="keyword">and</span> problem_id<span class="operator">&lt;=</span><span class="number">1009</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第9关-查询-language-不在-0-1-3-中的-solution-的-code-length">第9关 查询 language 不在 0、1、3 中的 solution 的 code_length</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> code_length <span class="keyword">FROM</span> solution</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">language</span> <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="number">0</span>,<span class="number">1</span>,<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第10关-查询2018级选手信息-user-id-为学号的用户前4位为年级">第10关 查询2018级选手信息（user_id 为学号的用户前4位为年级）</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users</span><br><span class="line"><span class="keyword">WHERE</span> user_id <span class="keyword">LIKE</span> <span class="string">&#x27;2018%&#x27;</span></span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第11关-查询-生医-专业选手信息-name-中有-生医-的选手">第11关 查询’生医’专业选手信息（name 中有 ‘生医’ 的选手）</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users</span><br><span class="line"><span class="keyword">WHERE</span> name <span class="keyword">LIKE</span> <span class="string">&#x27;%生医%&#x27;</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第12关-查询不属于任何比赛的solution的-solution-id-和-in-date-contest-id-为-null">第12关 查询不属于任何比赛的solution的 solution_id 和 in_date（contest_id 为 NULL）</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> solution_id,in_date <span class="keyword">FROM</span> solution</span><br><span class="line"><span class="keyword">WHERE</span> contest_id <span class="keyword">is</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第13关-查询-result-为-6-且-problem-id大于1010-的-solution-id与language">第13关 查询 result 为 6 且 problem_id大于1010 的 solution_id与language</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> solution_id,<span class="keyword">language</span> <span class="keyword">FROM</span> solution</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">result</span><span class="operator">=</span><span class="number">6</span> <span class="keyword">and</span> problem_id<span class="operator">&gt;</span><span class="number">1010</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第14关-查询提交过solution的选手人数">第14关 查询提交过solution的选手人数</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> user_id)</span><br><span class="line"><span class="keyword">FROM</span> solution;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第15关-查询耗内存-memory-最多的solution的内存消耗大小与-solution-id">第15关 查询耗内存（memory）最多的solution的内存消耗大小与 solution_id</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> memory,solution_id <span class="keyword">FROM</span> solution</span><br><span class="line"><span class="keyword">WHERE</span> memory  <span class="keyword">IN</span></span><br><span class="line">(</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="built_in">MAX</span>(memory)</span><br><span class="line">    <span class="keyword">FROM</span> solution</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第16关-查询每个题目的提交数">第16关 查询每个题目的提交数</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> problem_id,<span class="built_in">COUNT</span>(problem_id)</span><br><span class="line"><span class="keyword">FROM</span> solution</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> problem_id;</span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第17关-查询提交数大于20的题目的题号">第17关 查询提交数大于20的题目的题号</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> problem_id <span class="keyword">FROM</span> solution</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> problem_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(problem_id)<span class="operator">&gt;</span><span class="number">20</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第18关-查找所有problem-id-为1001-的解答或contest-id-为空的解答">第18关 查找所有problem_id 为1001 的解答或contest_id 为空的解答</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE `sqlexp<span class="operator">-</span>sztuoj`;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> solution</span><br><span class="line"><span class="keyword">WHERE</span> problem_id<span class="operator">=</span><span class="number">1001</span> <span class="keyword">or</span> contest_id <span class="keyword">is</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>实验3 MySQL的DDL语言</title>
      <link href="/posts/57811/"/>
      <url>/posts/57811/</url>
      
        <content type="html"><![CDATA[<h1 id="第1关-将p表中的所有红色零件的重量增加6">第1关 将P表中的所有红色零件的重量增加6</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line"></span><br><span class="line"><span class="keyword">UPDATE</span> P</span><br><span class="line"><span class="keyword">set</span> WEIGHT<span class="operator">=</span>WEIGHT<span class="operator">+</span><span class="number">6</span></span><br><span class="line"><span class="keyword">WHERE</span> COLOR<span class="operator">=</span><span class="string">&#x27;红&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> P;</span><br></pre></td></tr></table></figure><h1 id="第2关-把p表中全部红色零件的颜色改成蓝色">第2关 把P表中全部红色零件的颜色改成蓝色</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line"></span><br><span class="line"><span class="keyword">UPDATE</span> P</span><br><span class="line"><span class="keyword">SET</span> COLOR<span class="operator">=</span><span class="string">&#x27;蓝&#x27;</span></span><br><span class="line"><span class="keyword">WHERE</span> COLOR<span class="operator">=</span><span class="string">&#x27;红&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> P;</span><br></pre></td></tr></table></figure><h1 id="第3关-将spj表中由s5供给j4的零件p6改为由s3供应">第3关 将SPJ表中由S5供给J4的零件P6改为由S3供应</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line"></span><br><span class="line"><span class="keyword">UPDATE</span> SPJ</span><br><span class="line"><span class="keyword">SET</span> SNO<span class="operator">=</span>&quot;S3&quot;</span><br><span class="line"><span class="keyword">WHERE</span> PNO<span class="operator">=</span>&quot;P6&quot; <span class="keyword">AND</span> JNO<span class="operator">=</span>&quot;J4&quot; <span class="keyword">AND</span> SNO<span class="operator">=</span>&quot;S5&quot;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> SPJ;</span><br></pre></td></tr></table></figure><h1 id="第4关-将spj表中所有天津供应商的qty属性值减少11-用子查询方式">第4关 将SPJ表中所有天津供应商的QTY属性值减少11（用子查询方式）</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line"></span><br><span class="line"><span class="keyword">UPDATE</span> SPJ</span><br><span class="line"><span class="keyword">SET</span> QTY<span class="operator">=</span>QTY<span class="number">-11</span></span><br><span class="line"><span class="keyword">WHERE</span> SNO <span class="keyword">IN</span></span><br><span class="line">(</span><br><span class="line">    <span class="keyword">SELECT</span> SNO</span><br><span class="line">    <span class="keyword">FROM</span> S</span><br><span class="line">    <span class="keyword">WHERE</span> CITY<span class="operator">=</span><span class="string">&#x27;天津&#x27;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> SPJ;</span><br></pre></td></tr></table></figure><h1 id="第5关-删除j表中的所有工程项目在天津的记录">第5关 删除J表中的所有工程项目在天津的记录</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DELETE</span></span><br><span class="line"><span class="keyword">FROM</span> J</span><br><span class="line"><span class="keyword">WHERE</span> CITY<span class="operator">=</span><span class="string">&#x27;天津&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> J;</span><br></pre></td></tr></table></figure><h1 id="第6关-从spj表中删除供应商号是s2的记录">第6关 从SPJ表中删除供应商号是S2的记录</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">DELETE</span></span><br><span class="line"><span class="keyword">FROM</span> SPJ</span><br><span class="line"><span class="keyword">WHERE</span> SNO<span class="operator">=</span>&quot;S2&quot;;</span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> SPJ;</span><br></pre></td></tr></table></figure><h1 id="第7关-从spj表中删除零件名称为螺丝刀的记录-用子查询方式">第7关 从SPJ表中删除零件名称为螺丝刀的记录（用子查询方式）</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">DELETE</span></span><br><span class="line"><span class="keyword">FROM</span> SPJ</span><br><span class="line"><span class="keyword">WHERE</span> PNO <span class="keyword">IN</span></span><br><span class="line">(</span><br><span class="line">    <span class="keyword">SELECT</span> PNO</span><br><span class="line">    <span class="keyword">FROM</span> P</span><br><span class="line">    <span class="keyword">WHERE</span> PNAME<span class="operator">=</span>&quot;螺丝刀&quot;</span><br><span class="line">);  </span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> SPJ;</span><br></pre></td></tr></table></figure><h1 id="第8关-删除p表中所有的记录">第8关 删除P表中所有的记录</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> P;</span><br><span class="line"> </span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> P</span><br></pre></td></tr></table></figure><h1 id="第9关-请将-s2-j6-p4-200-插入供应情况关系表spj">第9关 请将(S2，J6，P4，200)插入供应情况关系表SPJ</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">INSERT</span></span><br><span class="line"><span class="keyword">INTO</span> SPJ(SNO,PNO,JNO,QTY)</span><br><span class="line"><span class="keyword">VALUES</span>(&quot;S2&quot;,&quot;P4&quot;,&quot;J6&quot;,<span class="number">200</span>);  </span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br><span class="line">#以下代码禁止删除</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> SPJ;</span><br></pre></td></tr></table></figure><h1 id="第10关-求供应工程j1零件的供应商号码sno">第10关 求供应工程J1零件的供应商号码SNO</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> SNO</span><br><span class="line"><span class="keyword">FROM</span> SPJ</span><br><span class="line"><span class="keyword">WHERE</span> JNO<span class="operator">=</span>&quot;J1&quot;;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第11关-求供应工程j1零件p1的供应商号码sno">第11关 求供应工程J1零件P1的供应商号码SNO</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">######### <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> SNO</span><br><span class="line"><span class="keyword">FROM</span> SPJ</span><br><span class="line"><span class="keyword">WHERE</span> JNO<span class="operator">=</span>&quot;J1&quot; <span class="keyword">AND</span> PNO<span class="operator">=</span>&quot;P1&quot;;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第12关-找出所有供应商的姓名和所在城市">第12关 找出所有供应商的姓名和所在城市</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> SNAME,CITY</span><br><span class="line"><span class="keyword">FROM</span> S</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第13关-找出所有零件的名称-颜色-重量">第13关 找出所有零件的名称、颜色、重量</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> PNAME,COLOR,WEIGHT</span><br><span class="line"><span class="keyword">FROM</span> P;</span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure><h1 id="第14关-找出使用供应商s1所供应零件的工程号码">第14关 找出使用供应商S1所供应零件的工程号码</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line">#请在此处添加实现代码</span><br><span class="line">########## <span class="keyword">Begin</span> ##########</span><br><span class="line"><span class="keyword">SELECT</span> JNO</span><br><span class="line"><span class="keyword">FROM</span> SPJ</span><br><span class="line"><span class="keyword">WHERE</span> SNO<span class="operator">=</span>&quot;S1&quot;;</span><br><span class="line"></span><br><span class="line">########## <span class="keyword">End</span> ##########</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>实验2 MySQL软件操作及建库建表建数据</title>
      <link href="/posts/33322/"/>
      <url>/posts/33322/</url>
      
        <content type="html"><![CDATA[<h1 id="第1关-创建数据库">第1关  创建数据库</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE mydata;</span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> databases;</span><br></pre></td></tr></table></figure><h1 id="第2关-创建供应商表s-并插入数据">第2关 创建供应商表S，并插入数据</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> S(</span><br><span class="line">   SNO <span class="type">CHAR</span>(<span class="number">2</span>),</span><br><span class="line">   SNAME <span class="type">VARCHAR</span>(<span class="number">5</span>),</span><br><span class="line">   STATUS <span class="type">INT</span>,</span><br><span class="line">   CITY <span class="type">CHAR</span>(<span class="number">2</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT INTO</span> S <span class="keyword">VALUES</span>(<span class="string">&#x27;S1&#x27;</span>,<span class="string">&#x27;精益&#x27;</span>,<span class="number">20</span>,<span class="string">&#x27;天津&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> S <span class="keyword">VALUES</span>(<span class="string">&#x27;S2&#x27;</span>,<span class="string">&#x27;盛锡&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;北京&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> S <span class="keyword">VALUES</span>(<span class="string">&#x27;S3&#x27;</span>,<span class="string">&#x27;东方红&#x27;</span>,<span class="number">30</span>,<span class="string">&#x27;北京&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> S <span class="keyword">VALUES</span>(<span class="string">&#x27;S4&#x27;</span>,<span class="string">&#x27;丰泰盛&#x27;</span>,<span class="number">20</span>,<span class="string">&#x27;天津&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> S <span class="keyword">VALUES</span>(<span class="string">&#x27;S5&#x27;</span>,<span class="string">&#x27;为民&#x27;</span>,<span class="number">30</span>,<span class="string">&#x27;上海&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> S;</span><br></pre></td></tr></table></figure><h1 id="第3关-创建零件表p-并插入数据">第3关 创建零件表P，并插入数据</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> P(</span><br><span class="line">    PNO <span class="type">CHAR</span>(<span class="number">2</span>),</span><br><span class="line">    PNAME <span class="type">VARCHAR</span>(<span class="number">5</span>),</span><br><span class="line">    COLOR <span class="type">CHAR</span>(<span class="number">1</span>),</span><br><span class="line">    WEIGHT <span class="type">INT</span></span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT INTO</span> P <span class="keyword">VALUES</span> (<span class="string">&#x27;P1&#x27;</span>,<span class="string">&#x27;螺母&#x27;</span>,<span class="string">&#x27;红&#x27;</span>,<span class="number">12</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> P <span class="keyword">VALUES</span> (<span class="string">&#x27;P2&#x27;</span>,<span class="string">&#x27;螺栓&#x27;</span>,<span class="string">&#x27;绿&#x27;</span>,<span class="number">17</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> P <span class="keyword">VALUES</span> (<span class="string">&#x27;P3&#x27;</span>,<span class="string">&#x27;螺丝刀&#x27;</span>,<span class="string">&#x27;蓝&#x27;</span>,<span class="number">14</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> P <span class="keyword">VALUES</span> (<span class="string">&#x27;P4&#x27;</span>,<span class="string">&#x27;螺丝刀&#x27;</span>,<span class="string">&#x27;红&#x27;</span>,<span class="number">14</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> P <span class="keyword">VALUES</span> (<span class="string">&#x27;P5&#x27;</span>,<span class="string">&#x27;凸轮&#x27;</span>,<span class="string">&#x27;蓝&#x27;</span>,<span class="number">40</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> P <span class="keyword">VALUES</span> (<span class="string">&#x27;P6&#x27;</span>,<span class="string">&#x27;齿轮&#x27;</span>,<span class="string">&#x27;红&#x27;</span>,<span class="number">30</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> P;</span><br></pre></td></tr></table></figure><h1 id="第4关-创建工程项目表j-并插入数据">第4关 创建工程项目表J，并插入数据</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> J(</span><br><span class="line">    JNO <span class="type">CHAR</span>(<span class="number">2</span>),</span><br><span class="line">    JNAME <span class="type">VARCHAR</span>(<span class="number">5</span>),</span><br><span class="line">    CITY <span class="type">CHAR</span>(<span class="number">2</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT INTO</span> J <span class="keyword">VALUES</span> (<span class="string">&#x27;J1&#x27;</span>,<span class="string">&#x27;三建&#x27;</span>,<span class="string">&#x27;北京&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> J <span class="keyword">VALUES</span> (<span class="string">&#x27;J2&#x27;</span>,<span class="string">&#x27;一汽&#x27;</span>,<span class="string">&#x27;长春&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> J <span class="keyword">VALUES</span> (<span class="string">&#x27;J3&#x27;</span>,<span class="string">&#x27;弹簧厂&#x27;</span>,<span class="string">&#x27;天津&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> J <span class="keyword">VALUES</span> (<span class="string">&#x27;J4&#x27;</span>,<span class="string">&#x27;造船厂&#x27;</span>,<span class="string">&#x27;天津&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> J <span class="keyword">VALUES</span> (<span class="string">&#x27;J5&#x27;</span>,<span class="string">&#x27;机车厂&#x27;</span>,<span class="string">&#x27;唐山&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> J <span class="keyword">VALUES</span> (<span class="string">&#x27;J6&#x27;</span>,<span class="string">&#x27;无线电厂&#x27;</span>,<span class="string">&#x27;常州&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> J <span class="keyword">VALUES</span> (<span class="string">&#x27;J7&#x27;</span>,<span class="string">&#x27;半导体厂&#x27;</span>,<span class="string">&#x27;南京&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> J;</span><br></pre></td></tr></table></figure><h1 id="第5关-创建供应情况表spj-并插入数据">第5关 创建供应情况表SPJ，并插入数据</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">USE mydata;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> SPJ(</span><br><span class="line">    SNO <span class="type">CHAR</span>(<span class="number">2</span>),</span><br><span class="line">    PNO <span class="type">CHAR</span>(<span class="number">2</span>),</span><br><span class="line">    JNO <span class="type">CHAR</span>(<span class="number">2</span>),</span><br><span class="line">    QTY <span class="type">INT</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT INTO</span> SPJ(SNO,PNO,JNO,QTY)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;S1&#x27;</span>, <span class="string">&#x27;P1&#x27;</span>, <span class="string">&#x27;J1&#x27;</span>, <span class="number">200</span>),</span><br><span class="line">    (<span class="string">&#x27;S1&#x27;</span>, <span class="string">&#x27;P1&#x27;</span>, <span class="string">&#x27;J3&#x27;</span>, <span class="number">100</span>),</span><br><span class="line">    (<span class="string">&#x27;S1&#x27;</span>, <span class="string">&#x27;P1&#x27;</span>, <span class="string">&#x27;J4&#x27;</span>, <span class="number">700</span>),</span><br><span class="line">    (<span class="string">&#x27;S1&#x27;</span>, <span class="string">&#x27;P2&#x27;</span>, <span class="string">&#x27;J2&#x27;</span>, <span class="number">100</span>),</span><br><span class="line">    (<span class="string">&#x27;S2&#x27;</span>, <span class="string">&#x27;P3&#x27;</span>, <span class="string">&#x27;J1&#x27;</span>, <span class="number">400</span>),</span><br><span class="line">    (<span class="string">&#x27;S2&#x27;</span>, <span class="string">&#x27;P3&#x27;</span>, <span class="string">&#x27;J2&#x27;</span>, <span class="number">200</span>),</span><br><span class="line">    (<span class="string">&#x27;S2&#x27;</span>, <span class="string">&#x27;P3&#x27;</span>, <span class="string">&#x27;J4&#x27;</span>, <span class="number">500</span>),</span><br><span class="line">    (<span class="string">&#x27;S2&#x27;</span>, <span class="string">&#x27;P3&#x27;</span>, <span class="string">&#x27;J5&#x27;</span>, <span class="number">400</span>),</span><br><span class="line">    (<span class="string">&#x27;S2&#x27;</span>, <span class="string">&#x27;P5&#x27;</span>, <span class="string">&#x27;J1&#x27;</span>, <span class="number">400</span>),</span><br><span class="line">    (<span class="string">&#x27;S2&#x27;</span>, <span class="string">&#x27;P5&#x27;</span>, <span class="string">&#x27;J2&#x27;</span>, <span class="number">100</span>),</span><br><span class="line">    (<span class="string">&#x27;S3&#x27;</span>, <span class="string">&#x27;P1&#x27;</span>, <span class="string">&#x27;J1&#x27;</span>, <span class="number">200</span>),</span><br><span class="line">    (<span class="string">&#x27;S3&#x27;</span>, <span class="string">&#x27;P3&#x27;</span>, <span class="string">&#x27;J1&#x27;</span>, <span class="number">200</span>),</span><br><span class="line">    (<span class="string">&#x27;S4&#x27;</span>, <span class="string">&#x27;P5&#x27;</span>, <span class="string">&#x27;J1&#x27;</span>, <span class="number">100</span>),</span><br><span class="line">    (<span class="string">&#x27;S4&#x27;</span>, <span class="string">&#x27;P6&#x27;</span>, <span class="string">&#x27;J3&#x27;</span>, <span class="number">300</span>),  </span><br><span class="line">    (<span class="string">&#x27;S4&#x27;</span>, <span class="string">&#x27;P6&#x27;</span>, <span class="string">&#x27;J4&#x27;</span>, <span class="number">200</span>),</span><br><span class="line">    (<span class="string">&#x27;S5&#x27;</span>, <span class="string">&#x27;P2&#x27;</span>, <span class="string">&#x27;J4&#x27;</span>, <span class="number">100</span>),</span><br><span class="line">    (<span class="string">&#x27;S5&#x27;</span>, <span class="string">&#x27;P3&#x27;</span>, <span class="string">&#x27;J1&#x27;</span>, <span class="number">200</span>),</span><br><span class="line">    (<span class="string">&#x27;S5&#x27;</span>, <span class="string">&#x27;P6&#x27;</span>, <span class="string">&#x27;J2&#x27;</span>, <span class="number">200</span>),</span><br><span class="line">    (<span class="string">&#x27;S5&#x27;</span>, <span class="string">&#x27;P6&#x27;</span>, <span class="string">&#x27;J4&#x27;</span>, <span class="number">500</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> SPJ;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OS报告</title>
      <link href="/posts/205686455/"/>
      <url>/posts/205686455/</url>
      
        <content type="html"><![CDATA[<p><a href="https://pan.baidu.com/share/init?surl=dp9Thx6mB8kHrWhWw2OHYw&amp;pwd=yaka">资料下载请点此处</a></p><p>操作系统的实验是基于linux系统，多数同学都是使用windows系统，此时需要安装Vmware应用来使用虚拟机，建议linux系统的版本为Ubuntu22，过于新的版本会存在一定的bug。</p><p>24年春季学期操作系统的报告内容及相关复习资料已存在网盘链接中，有需要的同学可以自行下载。<br>网盘中还存放Vmware安装包，激活密钥以及Ubuntu22的镜像。</p><p>推荐网课：<a href="https://www.bilibili.com/video/BV1qd4y177eA/?spm_id_from=333.337.search-card.all.click&amp;vd_source=7ea8b289c9b1077782b6b55d6b14d8fc">操作系统原理期末速成不挂科主攻大题_哔哩哔哩_bilibili</a></p>]]></content>
      
      
      <categories>
          
          <category> 题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 操作系统 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/posts/16107/"/>
      <url>/posts/16107/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="quick-start">Quick Start</h2><h3 id="create-a-new-post">Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="run-server">Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="generate-static-files">Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="deploy-to-remote-sites">Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>DataBase 数据类型</title>
      <link href="/posts/129956530/"/>
      <url>/posts/129956530/</url>
      
        <content type="html"><![CDATA[<h1 id="string-类型">String 类型</h1><ul><li>CHAR 固定长度字符串<ul><li>char会开辟指定个字符的一个储存空间，假如存放一个字符A，剩余的字符空着放那，别的字符也不可以使用。</li></ul></li><li>VARCHAR 可变长度字符串 max：64KB<ul><li>varchar会根据我们存放的字符的长度来开辟存储空间。</li></ul></li><li>LONGTEXT 长文本串 max：4GB</li></ul><h1 id="整数类型">整数类型</h1><ul><li>TINYINT<ul><li>占用字节：1B，数值范围：[-128, 127]</li></ul></li><li>UNSIGNED TINYINT (无符号微整型)<ul><li>数值范围：[0, 255]</li></ul></li><li>SMALLINT<ul><li>占用字节：2B，数值范围：[-32K, 32K]</li></ul></li><li>MEDIUMINT<ul><li>占用字节：3B，数值范围：[-8M, 8M]</li></ul></li><li>INT<ul><li>占用字节：4B，数值范围：[-2B, 2B]</li></ul></li><li>BIGINT<ul><li>占用字节：8B，数值范围：[-9Z, 9Z]</li></ul></li></ul><h1 id="浮点数类型">浮点数类型</h1><ul><li>DECIMAL(p,s)<ul><li>用于存储定点数 ，p决定存储数字的最大位数（包括整数位数和小数位数），s决定小数点后的位数</li></ul></li><li>FLOAT<ul><li>占用字节：4B</li></ul></li><li>DOUBLE<ul><li>占用字节：8B</li></ul></li><li>FLOAT和DOUBLE可用于存储对精度要求不高的数据</li></ul><h1 id="布尔类型">布尔类型</h1><p>BOOLEAN/BOOL  存储True或FALSE</p><h1 id="日期和时间类型">日期和时间类型</h1><ul><li>DATE<ul><li>只能存储到日期，无法存储具体时间</li></ul></li><li>TIME</li><li>DATETIME<ul><li>占用字节：8b</li></ul></li><li>TIMESTAMP（时间戳）<ul><li>占用字节：4b，只能存储到2038年以前的时间</li></ul></li><li>YEAR<ul><li>用于存储四位数的年份</li></ul></li></ul><h1 id="json类型">JSON类型</h1><h2 id="创建json对象-假设表中已有json类型的属性">创建JSON对象（假设表中已有JSON类型的属性）</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 法1</span></span><br><span class="line"><span class="keyword">UPDATE</span> products</span><br><span class="line"><span class="keyword">SET</span> properties <span class="operator">=</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">&quot;dimensions&quot; : [1,2,3],</span></span><br><span class="line"><span class="string">&quot;weight&quot; : 10,</span></span><br><span class="line"><span class="string">&quot;manufacturer&quot;:&#123;&quot;name&quot;:&quot;sony&quot;&#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&#x27;</span></span><br><span class="line"><span class="keyword">WHERE</span> product_id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 法2</span></span><br><span class="line"><span class="keyword">UPDATE</span> products</span><br><span class="line"><span class="keyword">SET</span> properties <span class="operator">=</span> <span class="built_in">JSON_OBJECT</span>(</span><br><span class="line"><span class="string">&#x27;weight&#x27;</span>,<span class="number">10</span>,</span><br><span class="line"><span class="string">&#x27;dimensions&#x27;</span>,<span class="built_in">JSON_ARRAY</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>),</span><br><span class="line"><span class="string">&#x27;manufacturer&#x27;</span>,<span class="built_in">JSON_OBJECT</span>(<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;sony&#x27;</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">WHERE</span> product_id <span class="operator">=</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><h2 id="json函数">JSON函数</h2><ul><li>JSON_OBJECT（参数1，参数2，…，参数n）<ul><li>参数1传入键（用引号括起的字符串）</li><li>参数2传入值</li></ul></li><li>JSON_ARRAY（参数1,…,参数n）<ul><li>用于建设长度为n的数组，传入的参数为数组内的值</li></ul></li><li>JSON_EXTRACT（参数1，参数2）<ul><li>参数1为JSON属性</li><li>参数2为要读取的键值对</li><li>示例：JSON_EXTRACT(properties,&quot;$.weight&quot;), $ 表示当前读取的JSON对象</li><li>简化写法：properties-&gt;’$.weight’，-&gt;&gt; 可用于读取不带引号的字符串</li></ul></li><li>JSON_SET（参数1，键1，值1，…)<ul><li>参数1传入JSON属性的列名</li><li>键1，值1，分别传入要修改的键和修改的值，键要用’$.键名’表示</li></ul></li><li>JSON_REMOVE(参数1，参数2，…)<ul><li>参数1传入JSON属性</li><li>参数2以后传入要删除的键</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DataBase 事务</title>
      <link href="/posts/1137404687/"/>
      <url>/posts/1137404687/</url>
      
        <content type="html"><![CDATA[<p>代表单个工作单元的一组SQL语句，在事务中的语句都应成功完成。<br>属性（ACID）：</p><ul><li>原子性(Atomicity) 事务不可中断,要么事务中所有语句被执行,要么事务被退回,执行的更改被撤销</li><li>一致性(Consistency) 数据库状态保持一致</li><li>隔离性质(Isolation) 事务之间彼此不受干扰，且一次只有一个事务可更新同样的数据（互斥）</li><li>持久性(Durability) 事务产生的更改是永久的</li></ul><h2 id="创建事务">创建事务</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">START</span> TRANSACTION; <span class="comment">-- 开启事务 </span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 要执行的语句</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COMMIT</span>; <span class="comment">-- 关闭事务</span></span><br></pre></td></tr></table></figure><h2 id="常见并发问题">常见并发问题</h2><ul><li>脏读（Dirty Reads）<ul><li>事务读取了尚未被提交的数据</li></ul></li><li>不可重复读（Non-repeating Reads）<ul><li>就是一个事务读到另一个事务修改后并提交的数据（update）。在同一个事务中，<strong>对于同一组数据读取到的结果不一致</strong></li></ul></li><li>幻读（Phantom Reads）<ul><li>事务B前后两次读取同一个范围的数据，在事务B两次读取的过程中事务A新增了数据，导致事务B后一次读取到前一次查询没有看到的行</li></ul></li><li>丢失更新<ul><li>同时有多个事务更新同样的数据，后提交的事务覆盖先前的事务</li></ul></li><li>死锁<ul><li>多个事务拿着不同事务需要更新数据的锁</li><li>出现原因：<ul><li>多个事务里对于同样的数据采用相反顺序进行更新</li></ul></li><li>解决方案：<ul><li>更新多条记录时采用相同顺序</li><li>简化事务，缩小事务运行时长</li><li>安排运行时长长的事务（基于大表）在非高峰时段进行</li></ul></li></ul></li></ul><h2 id="事务隔离级别">事务隔离级别</h2><h3 id="设置事务隔离级别">设置事务隔离级别</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;transaction_isolation&#x27;</span>; <span class="comment">-- 查看数据库的事务隔离级别</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> TRANSACTION ISOLATION LEVEL [隔离级别] <span class="comment">-- 为某个事物设置隔离级别</span></span><br><span class="line"><span class="keyword">SET</span> SESSION TRANSACTION ISOLATION LEVEL [隔离级别]</span><br><span class="line"><span class="comment">-- 为会话或连接设置隔离级别</span></span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">GLOBAL</span> TRANSACTIOn ISOLATION LEVEL [隔离级别]</span><br><span class="line"><span class="comment">-- 设置全局隔离级别</span></span><br></pre></td></tr></table></figure><ul><li>读未提交(READ UNCOMMITED)</li><li>读已提交(READ COMMITED)</li><li>可重复读(REPEATABLE READ)</li><li>序列化(SERIALIZABLE)  只在解决幻读问题的情况下使用该级别</li></ul>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DataBase 触发器和事件</title>
      <link href="/posts/1698569466/"/>
      <url>/posts/1698569466/</url>
      
        <content type="html"><![CDATA[<h1 id="触发器">触发器</h1><ul><li>MySQL触发器（Trigger）是一种特殊的存储过程，</li><li>它与表有关，当表上的特定事件（insert，update，delete）发生时，触发器会自动执行。</li><li>可以使用触发器来实现数据约束，数据验证，数据复制等功能<ul><li>数据复制：通过创建触发器，在给一张表插入数据的同时给另一张表插入同样的数据</li><li>数据验证：在插入或更新数据时，检查记录的某些字段是否符合要求，则拒绝插入或者更新，这样可以保证数据的完整性和一致性</li></ul></li><li>触发时间分为AFTER和BEFORE两种</li></ul><h2 id="创建触发器">创建触发器</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> payments_after_delete</span><br><span class="line"> AFTER <span class="keyword">DELETE</span> <span class="keyword">ON</span> payments</span><br><span class="line"> <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line"><span class="keyword">UPDATE</span> invoices</span><br><span class="line">    <span class="keyword">SET</span> payment_total <span class="operator">=</span> payment_total <span class="operator">-</span> OLD.amount</span><br><span class="line">    <span class="keyword">WHERE</span> invoice_id <span class="operator">=</span> OLD.invoice_id;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure><h2 id="查看触发器">查看触发器</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">TRIGGER</span> </span><br></pre></td></tr></table></figure><h2 id="删除触发器">删除触发器</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TRIGGER</span> IF <span class="keyword">EXISTS</span> [触发器]</span><br></pre></td></tr></table></figure><h1 id="事件">事件</h1><p>根据计划执行的任务或一堆SQL代码</p><h2 id="创建事件">创建事件</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> EVENT yearly_dalete_stale_audit_rows</span><br><span class="line"><span class="keyword">ON</span> SCHEDULE</span><br><span class="line"><span class="keyword">EVERY</span> <span class="number">1</span> <span class="keyword">YEAR</span> <span class="comment">-- 表示每年执行一次，可利用STARTS,ENDS 增加起止区间</span></span><br><span class="line"><span class="comment">-- AT + 具体日期 表示在该日期执行一次 </span></span><br><span class="line">DO <span class="keyword">BEGIN</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> payments_aduit</span><br><span class="line">    <span class="keyword">WHERE</span> action_date <span class="operator">&lt;</span> NOW() <span class="operator">-</span> <span class="type">INTERVAL</span> <span class="number">1</span> <span class="keyword">YEAR</span>;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure><h2 id="查看事件">查看事件</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> EVENTS;</span><br></pre></td></tr></table></figure><h2 id="删除事件">删除事件</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> EVENT IF <span class="keyword">EXISTS</span> [事件]</span><br></pre></td></tr></table></figure><h2 id="更改事件">更改事件</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> EVENT yearly_dalete_stale_audit_rows <span class="comment">-- 关键字为ALTER</span></span><br><span class="line"><span class="keyword">ON</span> SCHEDULE</span><br><span class="line"><span class="keyword">AT</span> <span class="string">&#x27;2024-05-18&#x27;</span></span><br><span class="line">DO <span class="keyword">BEGIN</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> payments_aduit</span><br><span class="line">    <span class="keyword">WHERE</span> action_date <span class="operator">&lt;</span> NOW() <span class="operator">-</span> <span class="type">INTERVAL</span> <span class="number">1</span> <span class="keyword">YEAR</span>;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ALTER还可以暂时启用或关闭事件</span></span><br><span class="line"><span class="keyword">ALTER</span> EVENT [事件] DISABLE <span class="operator">/</span> ENABLE;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DataBase 存储过程</title>
      <link href="/posts/1132319962/"/>
      <url>/posts/1132319962/</url>
      
        <content type="html"><![CDATA[<p>存储过程是一个包含一堆SQL代码的数据库对象</p><p>修改默认分隔符的原因：<br>在MySQL中创建存储过程时，我们通常需要修改默认的分隔符。原因是MySQL默认使用分号（;）作为SQL语句的结束标志。但在存储过程中，我们可能需要使用多条SQL语句，并且这些语句也是以分号结束的。<br>如果不修改默认的分隔符，MySQL会在遇到第一个分号时就认为存储过程的定义结束了，从而导致存储过程的创建失败。因此，我们通常在创建存储过程前先设置一个临时的分隔符（例如 $$)，然后在存储过程结束后再将分隔符改回分号。</p><h2 id="创建存储过程">创建存储过程</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$ <span class="comment">-- 修改默认分隔符</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> get_invoices_with_balance()</span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">    <span class="keyword">FROM</span> invoices_with_balance; <span class="comment">-- 在begin-end中，每一次的查询语句都用；分隔</span></span><br><span class="line"><span class="keyword">END</span>$$ <span class="comment">-- 使用修改后的默认分隔符来将begin-end中的内容视为一个整体</span></span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> get_invoices_with_balance() <span class="comment">-- 使用call命令调用存储过程</span></span><br></pre></td></tr></table></figure><h2 id="删除存储过程">删除存储过程</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">PROCEDURE</span> IF <span class="keyword">EXISTS</span> get_invoices_with_balance; </span><br></pre></td></tr></table></figure><h2 id="创建带参数的存储过程">创建带参数的存储过程</h2><ul><li>不带默认值</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> get_invoices_by_client(id <span class="type">INT</span>(<span class="number">11</span>))</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">    <span class="keyword">FROM</span> invoices i</span><br><span class="line">    <span class="keyword">WHERE</span> i.client_id <span class="operator">=</span> id;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure><ul><li>带默认值</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"><span class="keyword">CREATE</span> DEFINER<span class="operator">=</span>`root`@`localhost` <span class="keyword">PROCEDURE</span> `get_payments`(</span><br><span class="line">client_id <span class="type">INT</span>,</span><br><span class="line">    payment_method_id TINYINT</span><br><span class="line">)</span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">    <span class="keyword">FROM</span> payments p</span><br><span class="line">    <span class="keyword">WHERE</span> p.client_id <span class="operator">=</span> IFNULL(client_id,p.client_id) </span><br><span class="line">    <span class="comment">-- 如果提供的client_id为空，则返回所有client_id</span></span><br><span class="line">    <span class="keyword">AND</span> p.payment_method <span class="operator">=</span> IFNULL(payment_method_id,p.payment_method);</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure><h2 id="参数验证">参数验证</h2><p>在创建存储过程时加入判断语句，避免更新数据库时插入不合理的数据</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$ </span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> make_payment</span><br><span class="line">(</span><br><span class="line">invoice_id <span class="type">INT</span>,</span><br><span class="line">payment_amount <span class="type">DECIMAL</span>(<span class="number">9</span>,<span class="number">2</span>), </span><br><span class="line"><span class="comment">-- 前一个参数表示数字的总位数（包括小数部分和整数部分），后一个表示小数点后的位数</span></span><br><span class="line">payment_date <span class="type">DATE</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">IF payment_amount <span class="operator">&lt;=</span> <span class="number">0</span> <span class="keyword">THEN</span></span><br><span class="line">SIGNAL <span class="keyword">SQLSTATE</span> <span class="string">&#x27;22003&#x27;</span> <span class="comment">-- sqlstate的错误代码，网上可搜</span></span><br><span class="line"><span class="keyword">SET</span> MESSAGE_TEXT <span class="operator">=</span> <span class="string">&#x27;Invalid payment amount&#x27;</span></span><br><span class="line"><span class="keyword">END</span> IF;</span><br><span class="line"><span class="keyword">UPDATE</span> invoices i</span><br><span class="line"><span class="keyword">SET</span> </span><br><span class="line">i.payment_total <span class="operator">=</span> payment_amount,</span><br><span class="line">i.payment_data <span class="operator">=</span> payment_date</span><br><span class="line"><span class="keyword">WHERE</span> i.invoice_id <span class="operator">=</span> invoice_id;</span><br><span class="line"><span class="keyword">END</span> $$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure><h2 id="输出参数">输出参数</h2><p>通过程序得到返回值</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> get_unpaid_invoice_for_client</span><br><span class="line">(</span><br><span class="line">client_id <span class="type">INT</span>,</span><br><span class="line"><span class="keyword">OUT</span> invoices_count <span class="type">INT</span>, <span class="comment">-- 作为输出参数，需要使用OUT进行标记</span></span><br><span class="line"><span class="keyword">OUT</span> invoices_total <span class="type">DECIMAL</span>(<span class="number">9</span>,<span class="number">2</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>),<span class="built_in">SUM</span>(invoices_total)</span><br><span class="line"><span class="keyword">INTO</span> invoices_count,invoices_total <span class="comment">-- 将查询值传入输出参数</span></span><br><span class="line"><span class="keyword">FROM</span> invoices i</span><br><span class="line"><span class="keyword">WHERE</span> i.client_id <span class="operator">=</span> client_id <span class="keyword">AND</span> payment_total <span class="operator">=</span> <span class="number">0</span> </span><br><span class="line"><span class="keyword">END</span> $$</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询</span></span><br><span class="line"><span class="keyword">CALL</span> get_unpaid_invoice_for_client(<span class="number">3</span>,<span class="variable">@invoices_count</span>,<span class="variable">@invoices_total</span>)</span><br><span class="line"><span class="comment">-- 查询客户未支付的发票数和发票总金额</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@invoices_count</span>,<span class="variable">@invoices_total</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="变量">变量</h2><p>变量在mysql中分为两种：</p><ol><li>用户变量：在用户使用mysql期间会被保存，当用户下线时会被清除<br>格式：SET @变量名</li><li>本地变量：在存储过程和函数中定义的变量，在执行完毕后会被清除</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> get_risk_factor()</span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line"><span class="keyword">DECLARE</span> risk_factor <span class="type">DECIMAL</span>(<span class="number">9</span>,<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="number">0</span>; <span class="comment">-- DECLARE 声明变量</span></span><br><span class="line"><span class="keyword">DECLARE</span> invoices_total <span class="type">DECIMAL</span>(<span class="number">9</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">DECLARE</span> invoice_count <span class="type">INT</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>),<span class="built_in">SUM</span>(invoice_total)</span><br><span class="line"><span class="keyword">INTO</span> invoice_count,invoices_total</span><br><span class="line"><span class="keyword">FROM</span> invoices;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> risk_factor <span class="operator">=</span> invoices_total <span class="operator">/</span> invoice_count <span class="operator">*</span> <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> risk_factor;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure><h2 id="函数">函数</h2><p>函数不同于存储过程，它只能返回一列<br>函数的属性：</p><ol><li>DETERMINISTIC 确定性，相同的输入对象返回值相同</li><li>READ SQL DATA 读取SQL的数据</li><li>MODIFIES SQL DATA 修改SQL的数据</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> get_risk_factor_for_client</span><br><span class="line">(</span><br><span class="line">client_id <span class="type">INT</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">RETURNS</span> <span class="type">INT</span> <span class="comment">-- 确定函数返回值的类型</span></span><br><span class="line"><span class="keyword">READS</span> <span class="keyword">SQL</span> DATA <span class="comment">-- 确定函数的属性</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="keyword">DECLARE</span> risk_factor <span class="type">DECIMAL</span>(<span class="number">9</span>,<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="number">0</span>; <span class="comment">-- DECLARE 声明变量</span></span><br><span class="line"><span class="keyword">DECLARE</span> invoices_total <span class="type">DECIMAL</span>(<span class="number">9</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">DECLARE</span> invoices_count <span class="type">INT</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>),<span class="built_in">SUM</span>(invoice_total)</span><br><span class="line"><span class="keyword">INTO</span> invoices_count,invoices_total</span><br><span class="line"><span class="keyword">FROM</span> invoices i</span><br><span class="line"><span class="keyword">WHERE</span> i.client_id <span class="operator">=</span> client_id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> risk_factor <span class="operator">=</span> invoices_total <span class="operator">/</span> invoices_count <span class="operator">*</span> <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">RETURN</span> IFNULL(risk_factor,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">END</span> $$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DataBase 常用函数</title>
      <link href="/posts/802921560/"/>
      <url>/posts/802921560/</url>
      
        <content type="html"><![CDATA[<h2 id="数值函数">数值函数</h2><h3 id="round函数">ROUND函数</h3><p>格式：ROUND（value，parameter）<br>将value四舍五入到paramet位小数</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ROUND(<span class="number">5.7542</span>,<span class="number">2</span>)</span><br><span class="line"><span class="comment">-- 运行结果：5.75</span></span><br></pre></td></tr></table></figure><h3 id="truncate函数">TRUNCATE函数</h3><p>格式：TRUNCATE（value，parame）<br>将value截断到paramet位小数</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">TRUNCATE</span>(<span class="number">5.7552</span>,<span class="number">2</span>)</span><br><span class="line"><span class="comment">-- 运行结果：5.75</span></span><br></pre></td></tr></table></figure><h3 id="ceiling函数">CEILING函数</h3><p>格式：CELING（value）<br>返回大于或等于value的最小整数</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">CEILING</span>(<span class="number">5.76</span>)</span><br><span class="line"><span class="comment">-- 运行结果：6</span></span><br></pre></td></tr></table></figure><h3 id="floor函数">FLOOR函数</h3><p>格式：FLOOR（value）<br>返回小于或等于value的最大整数</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">FLOOR</span>(<span class="number">1.52</span>)</span><br><span class="line"><span class="comment">-- 运行结果：1</span></span><br></pre></td></tr></table></figure><h3 id="abs函数">ABS函数</h3><p>格式：ABS（value）<br>返回绝对值</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">ABS</span>(<span class="number">-5.2</span>)</span><br><span class="line"><span class="comment">-- 运行结果：5.2</span></span><br></pre></td></tr></table></figure><h3 id="rand函数">RAND函数</h3><p>生成0-1之间的随机值</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> RAND()</span><br></pre></td></tr></table></figure><h2 id="字符串函数">字符串函数</h2><h3 id="length函数">LENGTH函数</h3><p>格式：LENGTH（str）<br>返回字符串的字符个数</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> LENGTH(<span class="string">&#x27;sky&#x27;</span>)</span><br><span class="line"><span class="comment">-- 运行结果：3</span></span><br></pre></td></tr></table></figure><h3 id="upper函数">UPPER函数</h3><p>格式：UPPER（str）<br>返回大写的字符串</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">UPPER</span>(<span class="string">&#x27;sky&#x27;</span>)</span><br><span class="line"><span class="comment">-- 运行结果：SKY</span></span><br></pre></td></tr></table></figure><h3 id="lower函数">LOWER函数</h3><p>格式：LOWER（str）<br>返回小写的字符串</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">LOWER</span>(<span class="string">&#x27;SKY&#x27;</span>)</span><br><span class="line"><span class="comment">-- 运行结果：sky</span></span><br></pre></td></tr></table></figure><h3 id="trim函数">TRIM函数</h3><p>分为三种：TRIM，LTRIM，RTRIM<br>用于删除多余的空格</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">TRIM</span>(<span class="string">&#x27;   SKY   &#x27;</span>),  <span class="comment">-- 删除SKY前后多余的空格</span></span><br><span class="line">LTRIM(<span class="string">&#x27;   cat&#x27;</span>),  <span class="comment">-- 删除cat左边多余的空格</span></span><br><span class="line">    RTRIM(<span class="string">&#x27;dog  &#x27;</span>)  <span class="comment">-- 删除dog右边多余的空格</span></span><br></pre></td></tr></table></figure><h3 id="left函数">LEFT函数</h3><p>格式：LEFT（str，parameter）<br>从左侧开始返回parameter个字符</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">LEFT</span>(<span class="string">&#x27;Kingdom&#x27;</span>,<span class="number">4</span>)</span><br><span class="line"><span class="comment">-- 运行结果：King</span></span><br></pre></td></tr></table></figure><h3 id="right函数">RIGHT函数</h3><p>格式：RIGHT（str，parameter）<br>从右侧开始返回parameter个字符</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">RIGHT</span>(<span class="string">&#x27;Kingdom&#x27;</span>,<span class="number">3</span>)</span><br><span class="line"><span class="comment">-- 运行结果：dom</span></span><br></pre></td></tr></table></figure><h3 id="substring函数">SUBSTRING函数</h3><p>格式：SUBSTRING（str，start，end）<br>截取str的start位置到end位置，若无end则默认到str末尾</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUBSTRING</span>(<span class="string">&#x27;Kingdom&#x27;</span>,<span class="number">1</span>,<span class="number">4</span>)</span><br><span class="line"><span class="comment">-- 运行结果：King</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUBSTRING</span>(<span class="string">&#x27;Kingdom&#x27;</span>,<span class="number">2</span>)</span><br><span class="line"><span class="comment">-- 运行结果：ingdom</span></span><br></pre></td></tr></table></figure><h3 id="locate函数">LOCATE函数</h3><p>格式：LOCATE（str1，str2）<br>返回str1在str2第一次出现的位置</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> LOCATE(<span class="string">&#x27;n&#x27;</span>,<span class="string">&#x27;Kingarten&#x27;</span>)</span><br><span class="line"><span class="comment">-- 运行结果：3</span></span><br><span class="line"><span class="comment">-- MySQL的位置从1起</span></span><br></pre></td></tr></table></figure><h3 id="replace函数">REPLACE函数</h3><p>格式：REPLACE（str，str1，str2）<br>将str中的str1替换为str2</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> REPLACE(<span class="string">&#x27;Kingarten&#x27;</span>,<span class="string">&#x27;garten&#x27;</span>,<span class="string">&#x27;garden&#x27;</span>)</span><br><span class="line"><span class="comment">-- 运行结果：Kingarden</span></span><br></pre></td></tr></table></figure><h3 id="concat函数">CONCAT函数</h3><p>格式：CONCAT（str1，str2，……）<br>连接字符串</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> CONCAT(<span class="string">&#x27;John&#x27;</span>,<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;Smith&#x27;</span>)</span><br><span class="line"><span class="comment">-- 运行结果：John Smith</span></span><br></pre></td></tr></table></figure><h2 id="日期函数">日期函数</h2><table><thead><tr><th>NOW()</th><th>返回当前的时间</th></tr></thead><tbody><tr><td>CURDATE()</td><td>返回当前的日期</td></tr><tr><td>CURTIME()</td><td>返回当前的时刻</td></tr></tbody></table><h3 id="extract函数">EXTRACT函数</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">EXTRACT</span>(<span class="keyword">YEAR</span> <span class="keyword">FROM</span> NOW()) <span class="comment">-- 返回当前的年份</span></span><br><span class="line"><span class="comment">-- YEAR 可以更换为 MONTH，DAY，HOUR，MINUTE，SECOND等等</span></span><br></pre></td></tr></table></figure><h2 id="日期和时间的计算">日期和时间的计算</h2><ul><li>格式化日期和时间：<a href="https://dev.mysql.com/doc/refman/8.0/en/date-and-time-functions.html">MySQL :: MySQL 8.0 Reference Manual :: 14.7 Date and Time Functions</a></li></ul><h3 id="增加或减少日期">增加或减少日期</h3><ul><li>DATE_ADD(日期，INTERVAL 1 DAY) DAY可以替换为MONTH/YEAR</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DATE_ADD(<span class="string">&#x27;2020-01-01&#x27;</span>,<span class="type">INTERVAL</span> <span class="number">1</span> <span class="keyword">DAY</span>)</span><br><span class="line"><span class="comment">-- 结果：2020-01-02</span></span><br></pre></td></tr></table></figure><ul><li>DATE_SUB(日期，INTERVAL 1 DAY) DAY可以替换为MONTH/YEAR</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DATE_SUB(<span class="string">&#x27;2020-01-01&#x27;</span>,<span class="type">INTERVAL</span> <span class="number">1</span> <span class="keyword">DAY</span>)</span><br><span class="line"><span class="comment">-- 结果：2019-12-31</span></span><br></pre></td></tr></table></figure><ul><li>DATEDIFF(日期1，日期2)<br>以日期1减去日期2，求得两个日期之间的间隔，时间间隔不纳入考虑</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DATEDIFF(<span class="string">&#x27;2020-02-01&#x27;</span>,<span class="string">&#x27;2020-01-01&#x27;</span>)</span><br><span class="line"><span class="comment">-- 结果：31</span></span><br></pre></td></tr></table></figure><ul><li>TIME_TO_SEC(时刻)<br>将时刻转换为秒，从而易于计算，从凌晨0点开始计算</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> TIME_TO_SEC(<span class="string">&#x27;09:00&#x27;</span>)<span class="operator">-</span>TIME_TO_SEC(<span class="string">&#x27;05:00&#x27;</span>)</span><br><span class="line"><span class="comment">-- 结果：14400</span></span><br></pre></td></tr></table></figure><h2 id="其他函数">其他函数</h2><h3 id="ifnull函数">IFNULL函数</h3><p>格式：IFNULL(列名，字符串)<br>判断列值中是否有空值，若有空值，以字符串内容替换</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">order_id,</span><br><span class="line">IFNULL(shipper_id,<span class="string">&#x27;Not Assigned&#x27;</span>)</span><br><span class="line"><span class="keyword">FROM</span> orders</span><br></pre></td></tr></table></figure><h3 id="coalesce函数">COALESCE函数</h3><p>格式：COALESCE（列名1，列名2，…，字符串）<br>若列名1中存在空值，以同行列名2的值进行替换，若还为空则继续替换，直至以字符串内容替换</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">order_id,</span><br><span class="line"><span class="built_in">COALESCE</span>(shipper_id,comments,<span class="string">&#x27;Not Assigned&#x27;</span>)</span><br><span class="line"><span class="keyword">FROM</span> orders</span><br></pre></td></tr></table></figure><h3 id="if函数">IF函数</h3><p>格式：IF（表达式，返回值1，返回值2）<br>表达式成立则得到返回值1，否则得到返回值2</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">oi.product_id,</span><br><span class="line">    p.name,</span><br><span class="line">    <span class="built_in">COUNT</span>(<span class="operator">*</span>) orders,</span><br><span class="line">    IF(<span class="built_in">COUNT</span>(<span class="operator">*</span>)<span class="operator">&gt;</span><span class="number">1</span>,<span class="string">&#x27;Many times&#x27;</span>,<span class="string">&#x27;Once&#x27;</span>) frequency</span><br><span class="line"><span class="keyword">FROM</span> order_items oi</span><br><span class="line"><span class="keyword">JOIN</span> products p <span class="keyword">USING</span>(product_id)</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> oi.product_id,p.name</span><br></pre></td></tr></table></figure><h3 id="case运算符">CASE运算符</h3><p>格式： CASE WHEN 表达式 THEN 返回值 …… (ELSE) 返回值 END<br>通过多个测试语句返回不同的结果</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">CONCAT(first_name,<span class="string">&#x27; &#x27;</span>,last_name) customer,</span><br><span class="line">    points,</span><br><span class="line">    <span class="keyword">CASE</span> </span><br><span class="line">    <span class="keyword">WHEN</span> points<span class="operator">&gt;</span><span class="number">3000</span> <span class="keyword">THEN</span> <span class="string">&#x27;Gold&#x27;</span></span><br><span class="line">    <span class="keyword">WHEN</span> points <span class="keyword">BETWEEN</span> <span class="number">2000</span> <span class="keyword">AND</span> <span class="number">3000</span> <span class="keyword">THEN</span> <span class="string">&#x27;Sliver&#x27;</span></span><br><span class="line">    <span class="keyword">WHEN</span> points<span class="operator">&lt;</span><span class="number">2000</span> <span class="keyword">THEN</span> <span class="string">&#x27;Bronze&#x27;</span></span><br><span class="line">    <span class="keyword">END</span> <span class="keyword">AS</span> category</span><br><span class="line"><span class="keyword">FROM</span> customers</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> points <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DataBase 增删改语句</title>
      <link href="/posts/1419064164/"/>
      <url>/posts/1419064164/</url>
      
        <content type="html"><![CDATA[<h2 id="insert子句-插入数据">INSERT子句 插入数据</h2><ol><li>插入单行<br>格式：INSERT INTO 表名 （列名1，列名2，……） VALUES（值1，值2，……）</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT INTO</span> customers(first_name,last_name,address,city,state)</span><br><span class="line"><span class="comment">-- 列名属于可忽略部分，但通过写列名，可以不按表中的列名顺序插入，如果大量数据不按照表中列名顺序，可考虑写列名部分；同时写列名部分，可以只插入表中没有设定默认值的列值，其他则会设定为默认值</span></span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;xiling&#x27;</span>,<span class="string">&#x27;luo&#x27;</span>,<span class="string">&#x27;SZTU&#x27;</span>,<span class="string">&#x27;shenzhen&#x27;</span>,<span class="string">&#x27;GD&#x27;</span>)</span><br></pre></td></tr></table></figure><ol start="2"><li>插入多行<br>格式：INSERT INTO 表名 （列名1，列名2，……）<br>VALUES（值1，值2，……），（值1，值2，……），……</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT INTO</span> products(name,quantity_in_stock,unit_price)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;product4&#x27;</span>,<span class="number">25</span>,<span class="number">4.55</span>),</span><br><span class="line">(<span class="string">&#x27;product5&#x27;</span>,<span class="number">38</span>,<span class="number">3.50</span>)</span><br></pre></td></tr></table></figure><ol start="3"><li>插入分层行<br>若要在两个有关联的表插入有关联的元组数据，可通过LAST_INSERT_ID()调用上一条记录刚得到的id（该id为表中的主键，拥有自动递增特性）</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT INTO</span> orders(customer_id,order_date,status) </span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">12</span>,<span class="string">&#x27;2024-04-02&#x27;</span>,<span class="number">1</span>)；</span><br><span class="line"><span class="keyword">INSERT INTO</span> order_items </span><br><span class="line"><span class="keyword">VALUES</span>(LAST_INSERT_ID(),<span class="number">14</span>,<span class="number">1</span>,<span class="number">4.55</span>)；</span><br></pre></td></tr></table></figure><h3 id="建表并复制">建表并复制</h3><p>将某表的某些记录复制成另一个表，利用 <strong>CREATE TABLE 【表名】 AS</strong> 完成。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> invoices_archived <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> i.invoice_id,</span><br><span class="line">  i.number,</span><br><span class="line">     c.name client,</span><br><span class="line">     i.invoice_total,</span><br><span class="line">     i.payment_total,</span><br><span class="line">     i.invoice_date,</span><br><span class="line">     i.due_date,</span><br><span class="line">     i.payment_date</span><br><span class="line"><span class="keyword">FROM</span> clients c,invoices i</span><br><span class="line"><span class="keyword">WHERE</span> c.client_id <span class="operator">=</span> i.client_id <span class="keyword">AND</span> payment_date <span class="keyword">IS</span> <span class="keyword">NOT NULL</span></span><br><span class="line"><span class="comment">-- SELECT子句用于挑选被复制的记录</span></span><br></pre></td></tr></table></figure><h2 id="update子句-更新数据">UPDATE子句 更新数据</h2><ol><li>更新一行<br>格式：UPDATE 【表名】 SET 【列名1】= 值1,…… ，WHERE 条件（指定某一条记录的主键）</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> invoices</span><br><span class="line"><span class="keyword">SET</span> payment_total <span class="operator">=</span> <span class="number">10</span>, payment_date <span class="operator">=</span> <span class="string">&#x27;2019-03-01&#x27;</span></span><br><span class="line"><span class="keyword">WHERE</span> invoice_id <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure><ol start="2"><li>更新多行<br>格式：UPDATE 【表名】 SET 【列名1】= 值1,…… ，WHERE 条件</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> customers</span><br><span class="line"><span class="keyword">SET</span> points <span class="operator">=</span> points <span class="operator">+</span> <span class="number">50</span></span><br><span class="line"><span class="keyword">WHERE</span> birth_date <span class="operator">&lt;</span> <span class="string">&#x27;1990-01-01&#x27;</span>;</span><br></pre></td></tr></table></figure><ol start="3"><li>使用子查询的情况<br>在我们不知道WHERE的条件时，可以用子查询先得到我们所需要的条件，再进行更新。<br>如：我们需要更新订单表内的注释信息，但我们不知道顾客的id，只知道姓名，在这情况下就需要通过在顾客表找到姓名相对应的id，再到订单表更新注释</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> orders</span><br><span class="line"><span class="keyword">SET</span> comments <span class="operator">=</span> <span class="string">&#x27;Gold customers&#x27;</span></span><br><span class="line"><span class="keyword">WHERE</span> customer_id <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> customer_id</span><br><span class="line">    <span class="keyword">FROM</span> customers</span><br><span class="line">    <span class="keyword">WHERE</span> points <span class="operator">&gt;</span> <span class="number">3000</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><h2 id="delete子句-删除数据">DELETE子句 删除数据</h2><p>格式：DELETE FROM 【表名】 WHERE 【条件1】，……</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> invoices</span><br><span class="line"><span class="keyword">WHERE</span> client_id <span class="operator">=</span> (</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> clients</span><br><span class="line"><span class="keyword">WHERE</span> name <span class="operator">=</span> <span class="string">&#x27;Myworks&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DataBase 查询语句</title>
      <link href="/posts/1146913277/"/>
      <url>/posts/1146913277/</url>
      
        <content type="html"><![CDATA[<h2 id="select-语句">SELECT 语句</h2><ol><li>用于选择数据库中的某些列，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∗</mo></mrow><annotation encoding="application/x-tex">*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord">∗</span></span></span></span> 表示全部列。</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> [表名]; <span class="comment">-- 表示选中某表的全部列</span></span><br><span class="line"><span class="keyword">SELECT</span> [列名]<span class="operator">/</span>[列名<span class="number">1</span>],[列名<span class="number">2</span>],... <span class="keyword">FROM</span> [表名]; <span class="comment">-- 表示选中某表的某列/某些列</span></span><br></pre></td></tr></table></figure><ul><li>DISTINCT 关键字 用于去重查询</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> user_id</span><br><span class="line"><span class="keyword">FROM</span> solution;</span><br></pre></td></tr></table></figure><h2 id="关键字">关键字</h2><ol><li><strong>AS</strong><br>用于接列的别名（可省略）</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">name,</span><br><span class="line">unit_price,</span><br><span class="line">unit_price <span class="operator">*</span> <span class="number">1.1</span> <span class="keyword">AS</span> new_price <span class="operator">/</span> unit_price <span class="operator">*</span> <span class="number">1.1</span> new_price </span><br><span class="line"><span class="comment">-- 在显示查询结果时，unit_price * 1.1 这一列名会被别名new_price替代</span></span><br><span class="line"><span class="comment">-- 第三行左右两种写法表示同一种意思</span></span><br><span class="line"><span class="keyword">FROM</span> [表名];</span><br></pre></td></tr></table></figure><ol start="2"><li>ALL<br><strong>ALL</strong> 可以与(=、&gt;、&gt;=、&lt;、&lt;=、&lt;&gt;)结合是来使用，分别表示等于、大于、大于等于、小于、小于等于、不等于其中的其中的所有数据。<br><strong>ALL</strong> 关键字用在比较操作符(=、&gt;、&gt;=、&lt;、&lt;=、&lt;&gt;…)的后面，表示查询结果的多个数据中的所有都满足该比较操作符才算满足。</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> invoices</span><br><span class="line"><span class="keyword">WHERE</span> invoice_total <span class="operator">&gt;</span> <span class="keyword">ALL</span>(</span><br><span class="line"><span class="keyword">SELECT</span> invoice_total</span><br><span class="line">    <span class="keyword">FROM</span> invoices</span><br><span class="line">    <span class="keyword">WHERE</span> invoice_id <span class="operator">=</span> <span class="number">3</span></span><br><span class="line">)</span><br><span class="line"> <span class="comment">-- ALL返回（）里面所有的值，和invoice_total 逐一比较</span></span><br></pre></td></tr></table></figure><ol start="3"><li>ANY/SOME<br><strong>ANY/SOME</strong> 可以与(=、&gt;、&gt;=、&lt;、&lt;=、&lt;&gt;)结合起来使用，分别表示等于、大于、大于等于、小于、小于等于、不等于其中的任何一个数据。<br><strong>ANY/SOME</strong> 关键字用在比较操作符(=、&gt;、&gt;=、&lt;、&lt;=、&lt;&gt;…)的后面，表示查询结果的多个数据中的任一个满足该比较操作符就算满足。</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> clients</span><br><span class="line"><span class="keyword">WHERE</span> client_id <span class="operator">=</span> <span class="keyword">ANY</span>(</span><br><span class="line"><span class="keyword">SELECT</span> client_id </span><br><span class="line"><span class="keyword">FROM</span> invoices</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> client_id </span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="operator">&gt;=</span> <span class="number">2</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><h2 id="where-语句">WHERE 语句</h2><ol><li>作为增删查改等操作时的条件语句，用于过滤数据<br>下述以查询语句为例：</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> [表名]</span><br><span class="line"><span class="keyword">WHERE</span> [条件];</span><br></pre></td></tr></table></figure><h2 id="运算符">运算符</h2><h3 id="比较">比较</h3><table><thead><tr><th>大于</th><th>大于等于</th><th>小于</th><th>小于等于</th><th>等于</th><th>不等于</th><th>不大于</th><th>不小于</th><th>其他</th></tr></thead><tbody><tr><td>&gt;</td><td>&gt;=</td><td>&lt;</td><td>&lt;=</td><td>=</td><td>!= 或 &lt;&gt;</td><td>!&gt;</td><td>!&lt;</td><td>NOT+上述运算符</td></tr></tbody></table><h3 id="逻辑运算">逻辑运算</h3><table><thead><tr><th>AND</th><th>用于判定多个条件同时成立的情况</th></tr></thead><tbody><tr><td>OR</td><td>用于判定多个条件其中一个正确的情况</td></tr><tr><td>NOT</td><td>用于判定与某条件相反的情况</td></tr></tbody></table><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>N</mi><mi>D</mi></mrow><annotation encoding="application/x-tex">AND</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span>  和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mi>R</mi></mrow><annotation encoding="application/x-tex">OR</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span> 只能用于连接表示 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">true</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span></span></span></span> or <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>a</mi><mi>l</mi><mi>s</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">false</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span></span></span></span> 的逻辑语句，不能连接语句和字符串</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> customers</span><br><span class="line"><span class="keyword">WHERE</span> state <span class="operator">=</span> <span class="string">&#x27;VA&#x27;</span> <span class="keyword">OR</span> <span class="string">&#x27;GA&#x27;</span> <span class="keyword">OR</span> <span class="string">&#x27;FL&#x27;</span> <span class="comment">--这种条件语句无法成立</span></span><br></pre></td></tr></table></figure><h3 id="确定集合">确定集合</h3><table><thead><tr><th>IN</th><th>用于查询属性值在该集合内的元组</th></tr></thead><tbody><tr><td>NOT IN</td><td>用于查询属性值不在该集合内的元组</td></tr></tbody></table><table><thead><tr><th>EXISTS</th><th>用于查询符合条件的元组</th></tr></thead><tbody><tr><td>NOT EXISTS</td><td>用于查询不符合条件的元组</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> products p</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>(</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">    <span class="keyword">FROM</span> order_items oi</span><br><span class="line">    <span class="keyword">WHERE</span> p.product_id <span class="operator">=</span> oi.product_id</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- EXISTS 只返回True或False，不返回具体的值</span></span><br></pre></td></tr></table></figure><ul><li>外层小表，内层大表（或者将sql从左到右来看：左面小表，右边大表）： <strong>exists</strong> 比 <strong>in</strong> 的效率高</li><li>外层大表，内层小表（或者将sql从左到右来看：左面大表，右边小表）： <strong>in</strong> 比 <strong>exists</strong> 的效率高</li></ul><h3 id="确定范围">确定范围</h3><table><thead><tr><th>BETWEEN AND</th><th>查找属性值在指定范围内的元组</th></tr></thead><tbody><tr><td>NOT BETWEEN AND</td><td>查找属性值不在指定范围内的元组</td></tr></tbody></table><h3 id="字符匹配">字符匹配</h3><table><thead><tr><th>LIKE</th><th>查找指定属性列值与匹配串相匹配的元组</th></tr></thead><tbody><tr><td>NOT LIKE</td><td>查定指定属性列值不与匹配串匹配的元组</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> customers</span><br><span class="line"><span class="keyword">WHERE</span> address <span class="keyword">LIKE</span> ‘<span class="operator">%</span>trial<span class="operator">%</span>’</span><br><span class="line"><span class="comment">-- 格式： [NOT] LIKE &#x27;匹配串&#x27;</span></span><br><span class="line"><span class="comment">-- 通配符：（1）% 用于代表任意长度的字符串；（2）_ 用于代表单个字符</span></span><br></pre></td></tr></table></figure><h3 id="空值查询">空值查询</h3><table><thead><tr><th>IS NULL</th><th>查询某属性值为空的元组</th></tr></thead><tbody><tr><td>IS NOT NULL</td><td>查询某属性值非空的元组</td></tr></tbody></table><h2 id="order-by-语句">ORDER BY 语句</h2><ol><li>用于查询时按某列进行排序，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>E</mi><mi>S</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">DESC</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span> 是降序的缩写</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> order_items</span><br><span class="line"><span class="keyword">WHERE</span> order_id <span class="operator">=</span> <span class="number">2</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> quantity <span class="operator">*</span> unit_price <span class="keyword">DESC</span>; <span class="comment">-- 按照数量乘以单价后的总价进行降序排序</span></span><br><span class="line"><span class="comment">-- 格式：ORDER BY [列名称] </span></span><br></pre></td></tr></table></figure><h2 id="limit-语句">LIMIT 语句</h2><ol><li>用于限制查询记录输出</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> customers</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> points <span class="keyword">DESC</span></span><br><span class="line">LIMIT <span class="number">3</span>; <span class="comment">-- 表示只输出前三条记录</span></span><br></pre></td></tr></table></figure><ul><li>OFFSET 关键词表示偏移量</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> customers</span><br><span class="line">LIMIT <span class="number">6</span>,<span class="number">3</span> <span class="comment">-- 表示以3条记录为一页，跨过前6条记录并展示</span></span><br><span class="line">LIMIT <span class="number">3</span> <span class="keyword">OFFSET</span> <span class="number">6</span> <span class="comment">-- 与上一条LIMIT语句表达意思相同</span></span><br></pre></td></tr></table></figure><h2 id="子查询">子查询</h2><p>子查询指一个查询语句嵌套在另一个查询语句内部的查询</p><ul><li>不相关子查询：子查询的查询条件不依赖于父查询，称为不相关子查询。</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Sno,Sname,Sdept</span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> Sdept <span class="keyword">IN</span>(</span><br><span class="line"><span class="keyword">SELECT</span> Sdept </span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> Sname<span class="operator">=</span><span class="string">&#x27;刘晨&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><ul><li>相关子查询：如果子查询的查询条件依赖于父查询，这类子查询称为相关子查询。</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> invoices A</span><br><span class="line"><span class="keyword">WHERE</span> invoice_total <span class="operator">&gt;</span>(</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(invoice_total)</span><br><span class="line">    <span class="keyword">FROM</span> invoices</span><br><span class="line">    <span class="keyword">WHERE</span> client_id <span class="operator">=</span> A.client_id</span><br><span class="line">);</span><br></pre></td></tr></table></figure><ul><li>SELECT子句中的子查询</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">c.client_id,</span><br><span class="line">    name,</span><br><span class="line">    (<span class="keyword">SELECT</span> <span class="built_in">SUM</span>(invoice_total) <span class="keyword">FROM</span> invoices <span class="keyword">WHERE</span> client_id <span class="operator">=</span> c.client_id) <span class="keyword">AS</span> total_sales,</span><br><span class="line">    (<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(invoice_total) <span class="keyword">FROM</span> invoices) <span class="keyword">AS</span> average,</span><br><span class="line">    (<span class="keyword">SELECT</span> total_sales <span class="operator">-</span> average) <span class="keyword">AS</span> difference</span><br><span class="line"><span class="keyword">FROM</span> clients c</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> invoices i <span class="keyword">USING</span> (client_id)</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">by</span> c.client_id,name,difference;</span><br></pre></td></tr></table></figure><ul><li>FROM子句中的子查询<br>FROM子句中的子查询可以调用我们经过复杂查询后产生的虚拟表格进行简单的查询。但这种子查询会增加的代码复杂度，在后面我们可以用视图保存复杂查询后的表格——&gt;【视图】</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span>(</span><br><span class="line">    <span class="keyword">SELECT</span> </span><br><span class="line">        c.client_id,</span><br><span class="line">         name,</span><br><span class="line">        (<span class="keyword">SELECT</span> <span class="built_in">SUM</span>(invoice_total) <span class="keyword">FROM</span> invoices <span class="keyword">WHERE</span> client_id <span class="operator">=</span> c.client_id) total_sales,</span><br><span class="line">        (<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(invoice_total) <span class="keyword">FROM</span> invoices) average,</span><br><span class="line">        (<span class="keyword">SELECT</span> total_sales <span class="operator">-</span> average) difference</span><br><span class="line"><span class="keyword">FROM</span> clients c</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> invoices i <span class="keyword">USING</span> (client_id)</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> c.client_id,name</span><br><span class="line">) <span class="keyword">AS</span> sales_summary</span><br><span class="line"><span class="keyword">WHERE</span> total_sales <span class="keyword">IS</span> <span class="keyword">NOT NULL</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DataBase 聚合函数</title>
      <link href="/posts/3438945314/"/>
      <url>/posts/3438945314/</url>
      
        <content type="html"><![CDATA[<h2 id="函数简述">函数简述</h2><table><thead><tr><th>MAX()</th><th>求该列中的最大值</th></tr></thead><tbody><tr><td>MIN()</td><td>求该列中的最小值</td></tr><tr><td>AVG()</td><td>求该列的平均值</td></tr><tr><td>SUM()</td><td>求该列的值之和</td></tr><tr><td>COUNT()</td><td>统计该列中有多少条记录</td></tr></tbody></table><ol><li>所有聚合函数只计算非空值。</li><li>不能用于WHERE子句<br>（因为聚合函数是对已确定的数据集进行处理，而WHERE子句属于还在确定的阶段）</li></ol><h2 id="group-by子句">GROUP BY子句</h2><p>根据一定的规则，进行分组，以by后面跟着的一个或多个字段进行分组</p><ol><li>格式：select 聚合函数(字段1)，字段2 from 表名 where 条件 group by 字段2,字段3</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">p.date,</span><br><span class="line">pm.name payment_method,</span><br><span class="line"><span class="built_in">SUM</span>(amount) total_payments</span><br><span class="line"><span class="keyword">FROM</span> payments p, payment_methods pm</span><br><span class="line"><span class="keyword">WHERE</span> p.payment_method <span class="operator">=</span> pm.payment_method_id</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="type">date</span>, name;</span><br></pre></td></tr></table></figure><ol start="2"><li>通过HAVING子句过滤分组后的数据<br>格式：select 聚合函数(字段1)，字段2 from 表名 where 条件 group by 字段2,字段3 having 过滤条件</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">c.customer_id,</span><br><span class="line">    c.first_name,</span><br><span class="line">    c.last_name,</span><br><span class="line">    <span class="built_in">SUM</span>(oi.quantity <span class="operator">*</span> oi.unit_price) <span class="keyword">AS</span> total_sales</span><br><span class="line"><span class="keyword">FROM</span> customers c</span><br><span class="line"><span class="keyword">JOIN</span> orders o <span class="keyword">USING</span>(customer_id)</span><br><span class="line"><span class="keyword">JOIN</span> order_items oi <span class="keyword">USING</span>(order_id)</span><br><span class="line"><span class="keyword">WHERE</span> state <span class="operator">=</span> <span class="string">&#x27;VA&#x27;</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> </span><br><span class="line">c.customer_id,</span><br><span class="line">    c.first_name,</span><br><span class="line">    c.last_name</span><br><span class="line"><span class="keyword">HAVING</span> total_sales<span class="operator">&gt;</span><span class="number">100</span>;</span><br></pre></td></tr></table></figure><h2 id="rollup-运算符">ROLLUP 运算符</h2><p>用于计算总和，但只能用于聚合值的列，且使用时，GROUP BY 后的字段不能用别名<br><strong>注：ROLLUP只适用于Mysql</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">name payment_method,</span><br><span class="line">    <span class="built_in">SUM</span>(p.amount) total</span><br><span class="line"><span class="keyword">FROM</span> payments p</span><br><span class="line"><span class="keyword">JOIN</span> payment_methods pm</span><br><span class="line"><span class="keyword">ON</span> p.payment_method <span class="operator">=</span> pm.payment_method_id</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> name <span class="keyword">WITH</span> <span class="keyword">ROLLUP</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DataBase 视图</title>
      <link href="/posts/2160201343/"/>
      <url>/posts/2160201343/</url>
      
        <content type="html"><![CDATA[<p>数据库中的视图是一个虚拟表，同真实的表一样，视图包含一系列带有名称的行和列数据，行和列数据来自定义视图查询所引用的表，并且在引用视图时动态生成。但视图并不提供数据</p><h2 id="创建视图">创建视图</h2><p>格式：CREATE VIEW 【视图名】 AS  + 查询语句</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> clients_balance <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">i.client_id,</span><br><span class="line">    name,</span><br><span class="line">    <span class="built_in">SUM</span>(invoice_total<span class="operator">-</span>payment_total) balance</span><br><span class="line"><span class="keyword">FROM</span> invoices i</span><br><span class="line"><span class="keyword">JOIN</span> clients c <span class="keyword">USING</span>(client_id)</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> i.client_id,name</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> i.client_id;</span><br></pre></td></tr></table></figure><h2 id="删除视图">删除视图</h2><p>格式：DROP VIEW 【视图名】</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> clients_balance</span><br></pre></td></tr></table></figure><h2 id="更改视图">更改视图</h2><p>格式：CREATE OR REPLACE VIEW 【视图名】 AS + 查询语句</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> sales_by_clients <span class="keyword">AS</span>  <span class="comment">-- 创建或更新sales_by_clients视图</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">c.client_id,</span><br><span class="line">c.name,</span><br><span class="line"><span class="built_in">SUM</span>(invoice_total) total_sales</span><br><span class="line"><span class="keyword">FROM</span> clients c</span><br><span class="line"><span class="keyword">JOIN</span> invoices i <span class="keyword">USING</span>(client_id)</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> client_id, name</span><br></pre></td></tr></table></figure><h2 id="可更新视图">可更新视图</h2><p>可以使用INSERT、UPDATE、DELETE语句的视图<br><strong>成立条件：没有使用DISTINCT，聚合函数，GROUP BY子句/HAVING子句，UNION的视图</strong><br>示例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> invoices_with_balance <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">invoice_id,</span><br><span class="line">number,</span><br><span class="line">client_id,</span><br><span class="line">invoice_total,</span><br><span class="line">payment_total,</span><br><span class="line">invoice_total <span class="operator">-</span> payment_total <span class="keyword">AS</span> balance,</span><br><span class="line">invoice_date,</span><br><span class="line">due_date,</span><br><span class="line">payment_date</span><br><span class="line"><span class="keyword">FROM</span> invoices</span><br><span class="line"><span class="keyword">WHERE</span> (invoice_total <span class="operator">-</span> payment_total) <span class="operator">&gt;</span> <span class="number">0</span></span><br></pre></td></tr></table></figure><h2 id="with-check-option子句">WITH CHECK OPTION子句</h2><p>添加在创建视图语句的最后，在使用UPDATE语句或DELETE语句更新视图时，<strong>假如该行为会使视图中的某行消失，系统会返回错误提示</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> invoices_with_balance <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">invoice_id,</span><br><span class="line">number,</span><br><span class="line">client_id,</span><br><span class="line">invoice_total,</span><br><span class="line">payment_total,</span><br><span class="line">invoice_total <span class="operator">-</span> payment_total <span class="keyword">AS</span> balance,</span><br><span class="line">invoice_date,</span><br><span class="line">due_date,</span><br><span class="line">payment_date</span><br><span class="line"><span class="keyword">FROM</span> invoices</span><br><span class="line"><span class="keyword">WHERE</span> (invoice_total <span class="operator">-</span> payment_total) <span class="operator">&gt;</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">WITH</span> <span class="keyword">CHECK</span> OPTION；</span><br><span class="line"></span><br><span class="line"><span class="keyword">UPDATE</span> invoices_with_balance</span><br><span class="line"><span class="keyword">SET</span> payment_total <span class="operator">=</span> invoice_total</span><br><span class="line"><span class="keyword">WHERE</span> invoice_id <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"><span class="comment">-- 查询结果：#1369 - CHECK OPTION failed &#x27;sql_invoicing.invoices_with_balance&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DataBase 连接</title>
      <link href="/posts/4201200877/"/>
      <url>/posts/4201200877/</url>
      
        <content type="html"><![CDATA[<h1 id="内连接-inner-join">内连接 —— INNER JOIN</h1><ol><li>用于连接两个表的数据，通过<strong>ON关键字+条件语句</strong>来过滤数据</li></ol><ul><li>内连接不加关联条件的结果就是笛卡尔积</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> order_id,o.product_id,quantity,o.unit_price</span><br><span class="line"><span class="keyword">FROM</span> order_items o</span><br><span class="line">（<span class="keyword">INNER</span>） <span class="keyword">JOIN</span> products p <span class="comment">--实际INNER可写可不写，结果一致</span></span><br><span class="line"> <span class="keyword">ON</span> o.product_id <span class="operator">=</span> p.product_id</span><br></pre></td></tr></table></figure><h2 id="跨表连接">跨表连接</h2><ol><li>用于连接不同数据库的多张表的数据，通过在表名前加上相应的数据库前缀来实现</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> order_items oi</span><br><span class="line"><span class="keyword">JOIN</span> sql_inventory.products p</span><br><span class="line"><span class="keyword">ON</span> oi.product_id <span class="operator">=</span> p.product_id;</span><br></pre></td></tr></table></figure><h2 id="自连接">自连接</h2><ol><li>通过给同一张表取两个别名来实现自连接</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">e.employee_id,</span><br><span class="line">    e.first_name,</span><br><span class="line">    m.first_name</span><br><span class="line"><span class="keyword">FROM</span> employees e</span><br><span class="line"><span class="keyword">JOIN</span> employees m</span><br><span class="line"><span class="keyword">ON</span> e.reports_to <span class="operator">=</span> m.employee_id;</span><br></pre></td></tr></table></figure><h2 id="多表连接">多表连接</h2><ol><li>通过多个JOIN语句来实现多表连接</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">p.payment_id,</span><br><span class="line">    c.name <span class="keyword">AS</span> name, </span><br><span class="line">    p.invoice_id,</span><br><span class="line">    p.date,</span><br><span class="line">    p.amount,</span><br><span class="line">    pm.name <span class="keyword">AS</span> payment_method</span><br><span class="line"><span class="keyword">FROM</span> payments p</span><br><span class="line"><span class="keyword">JOIN</span> payment_methods pm</span><br><span class="line"><span class="keyword">ON</span> p.payment_method <span class="operator">=</span> pm.payment_method_id</span><br><span class="line"><span class="keyword">JOIN</span> clients c</span><br><span class="line"><span class="keyword">ON</span> p.client_id <span class="operator">=</span> c.client_id;</span><br></pre></td></tr></table></figure><h2 id="复合连接">复合连接</h2><ol><li>当表的记录是通过多列作为复合主键来作为唯一标识时，需要通过复合条件来实现连接</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> order_items oi</span><br><span class="line"><span class="keyword">JOIN</span> order_item_notes oin</span><br><span class="line"><span class="keyword">ON</span> oi.order_id <span class="operator">=</span> oin.order_id</span><br><span class="line">    <span class="keyword">AND</span> oi.product_id <span class="operator">=</span> oin.product_id;</span><br></pre></td></tr></table></figure><h2 id="隐式连接">隐式连接</h2><ol><li>除了使用JOIN语句，还可以使用WHERE子句来实现连接</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> orders o, customers c</span><br><span class="line"><span class="keyword">WHERE</span> o.customer_id <span class="operator">=</span> c.customer_id; <span class="comment">-- 注意：不写WHERE子句会出笛卡尔积的情况</span></span><br></pre></td></tr></table></figure><h1 id="外连接-outer-join">外连接 —— OUTER JOIN</h1><p>悬浮元组：内连接时不满足条件而被舍弃的元组<br>左外连接：A<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⋊</mo></mrow><annotation encoding="application/x-tex">\rtimes</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66334em;vertical-align:-0.08167em;"></span><span class="mord amsrm">⋊</span></span></span></span>B，假设有表A、B，通过左外连接(LEFT OUTER JOIN)会保留表A的悬浮元组<br>右外连接：A<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⋉</mo></mrow><annotation encoding="application/x-tex">\ltimes</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66334em;vertical-align:-0.08167em;"></span><span class="mord amsrm">⋉</span></span></span></span>B，假设有表A、B，通过右外连接(RIGHT OUTER JOIN)会保留表B的悬浮元组</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">p.product_id,</span><br><span class="line">    p.name,</span><br><span class="line">    oi.quantity</span><br><span class="line"><span class="keyword">FROM</span> products p</span><br><span class="line"><span class="keyword">LEFT</span> (<span class="keyword">OUTER</span>) <span class="keyword">JOIN</span> order_items oi <span class="comment">--OUTER与INNER一样可写可不写</span></span><br><span class="line"><span class="keyword">ON</span> p.product_id <span class="operator">=</span> oi.product_id;</span><br></pre></td></tr></table></figure><h2 id="多表外连接">多表外连接</h2><p>根据实际需要查询的情况，来使用相应的外连接</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">o.order_date,</span><br><span class="line">    o.order_id,</span><br><span class="line">    c.first_name,</span><br><span class="line">    sh.name <span class="keyword">AS</span> shipper,  </span><br><span class="line">    os.name <span class="keyword">AS</span> status</span><br><span class="line"><span class="keyword">FROM</span> orders o</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> shippers sh  </span><br><span class="line"><span class="comment">-- 因为orders表里部分订单没有发货人信息，如果不使用外连接，我们无法得到所有订单的信息</span></span><br><span class="line"><span class="keyword">ON</span> sh.shipper_id <span class="operator">=</span> o.shipper_id</span><br><span class="line"><span class="keyword">JOIN</span> order_statuses os</span><br><span class="line"><span class="keyword">ON</span> os.order_status_id <span class="operator">=</span> o.status</span><br><span class="line"><span class="keyword">JOIN</span> customers c</span><br><span class="line"><span class="keyword">ON</span> c.customer_id <span class="operator">=</span> o.customer_id;</span><br></pre></td></tr></table></figure><h2 id="自外连接">自外连接</h2><p>在数据库sql_hr中，employees表中有一条记录的report_to列为空值，当我们使用内连接时，就无法查询到该条记录的信息，但实际查询是要显示所有员工的信息，那这时候就需要使用外连接</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE sql_hr;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">e.employee_id,</span><br><span class="line">    e.first_name,</span><br><span class="line">    m.first_name <span class="keyword">AS</span> manager</span><br><span class="line"><span class="keyword">FROM</span> employees e</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> employees m</span><br><span class="line"><span class="keyword">ON</span> e.reports_to <span class="operator">=</span> m.employee_id;</span><br></pre></td></tr></table></figure><h2 id="using子句">USING子句</h2><p>用于JOIN语句过滤数据的另一个关键字，只能用于<strong>两个表中列名称相同的列</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">p.date,</span><br><span class="line">    c.name client,</span><br><span class="line">    p.amount,</span><br><span class="line">    pm.name payment_method</span><br><span class="line"><span class="keyword">FROM</span> payments p</span><br><span class="line"><span class="keyword">JOIN</span> clients c</span><br><span class="line"><span class="keyword">USING</span>(client_id)</span><br><span class="line"><span class="keyword">JOIN</span> payment_methods pm</span><br><span class="line"><span class="keyword">ON</span> p.payment_method <span class="operator">=</span> pm.payment_method_id</span><br><span class="line"><span class="comment">--因为p表中的payment_method和pm表中的payment_method_id名称不同，故不能使用USING</span></span><br></pre></td></tr></table></figure><h2 id="自然连接">自然连接</h2><p>自然连接是一种特殊的等值连接，他要求两个关系表中进行连接的必须是相同的属性列（名字相同），无须添加连接条件，并且在结果中消除重复的属性列。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">o.order_id,</span><br><span class="line">    c.first_name</span><br><span class="line"><span class="keyword">FROM</span> orders o </span><br><span class="line"><span class="keyword">NATURAL</span> <span class="keyword">JOIN</span> customers c;</span><br></pre></td></tr></table></figure><h2 id="交叉连接">交叉连接</h2><p>交叉连接（CROSS JOIN）一般用来返回连接表的笛卡尔积</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--显式语法</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">c.first_name customer,</span><br><span class="line">    p.name product</span><br><span class="line"><span class="keyword">FROM</span> customers c</span><br><span class="line"><span class="keyword">CROSS</span> <span class="keyword">JOIN</span> products p</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> c.first_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">--隐式语法</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">c.first_name customer,</span><br><span class="line">    p.name product</span><br><span class="line"><span class="keyword">FROM</span> customers c,products p</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> c.first_name;</span><br></pre></td></tr></table></figure><h2 id="联合">联合</h2><p>UNION，将多条select语句的结果，在字段数相同(即Select语句返回的结果列数相同)的情况下，在记录的层次上进行拼接。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">customer_id,</span><br><span class="line">    first_name,</span><br><span class="line">    points,</span><br><span class="line">    &quot;Bronze&quot; <span class="keyword">AS</span> types</span><br><span class="line"><span class="keyword">FROM</span> customers</span><br><span class="line"><span class="keyword">WHERE</span> points <span class="operator">&lt;</span> <span class="number">2000</span></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">customer_id,</span><br><span class="line">    first_name,</span><br><span class="line">    points,</span><br><span class="line">    &quot;Silver&quot; <span class="keyword">AS</span> types</span><br><span class="line"><span class="keyword">FROM</span> customers</span><br><span class="line"><span class="keyword">WHERE</span> points <span class="keyword">between</span> <span class="number">2000</span> <span class="keyword">and</span> <span class="number">3000</span></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">customer_id,</span><br><span class="line">    first_name,</span><br><span class="line">    points,</span><br><span class="line">    &quot;Gold&quot; <span class="keyword">AS</span> types</span><br><span class="line"><span class="keyword">FROM</span> customers</span><br><span class="line"><span class="keyword">WHERE</span> points <span class="operator">&gt;</span> <span class="number">3000</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> first_name; </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
  
  
    
    
    <entry>
      <title>categories</title>
      <link href="/categories/index.html"/>
      <url>/categories/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>tags</title>
      <link href="/tags/index.html"/>
      <url>/tags/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
  
</search>
